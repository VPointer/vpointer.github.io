<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="Y0-gFMBzGnbrueUrh8PjkmnvCGItjob2oR3HjG9SVnE">
  <meta name="msvalidate.01" content="97A49017D4D536B99438C4EE0E9FBA3F">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.zuiqiangiron.xyz","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="《R语言实战》笔记。 R语言入门内容。">
<meta property="og:type" content="article">
<meta property="og:title" content="R语言入门">
<meta property="og:url" content="https://www.zuiqiangiron.xyz/2020/04/16/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/index.html">
<meta property="og:site_name" content="嘴强黑铁">
<meta property="og:description" content="《R语言实战》笔记。 R语言入门内容。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587272016/R/%E6%95%A3%E7%82%B9%E5%9B%BE2.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587273485/R/pch.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587273485/R/lty.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587281302/R/layout.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587282292/R/fig.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587281302/R/par_fig.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587354607/R/%E5%B8%B8%E8%A7%81%E6%A6%82%E7%8E%87%E5%88%86%E5%B8%83.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587354940/R/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0%E7%A4%BA%E4%BE%8B.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587356066/R/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587356385/R/%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0.png">
<meta property="og:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587366667/R/%E8%9E%8D%E5%90%88%E4%B8%8E%E9%87%8D%E9%93%B8.png">
<meta property="article:published_time" content="2020-04-16T10:30:00.000Z">
<meta property="article:modified_time" content="2020-04-21T01:08:54.080Z">
<meta property="article:author" content="嘴强黑铁">
<meta property="article:tag" content="R语言">
<meta property="article:tag" content="R语言入门">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://res.cloudinary.com/vpointer/image/upload/v1587272016/R/%E6%95%A3%E7%82%B9%E5%9B%BE2.png">

<link rel="canonical" href="https://www.zuiqiangiron.xyz/2020/04/16/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>R语言入门 | 嘴强黑铁</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-161480657-1"></script>
    <script pjax>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-161480657-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">嘴强黑铁</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">天下事以难而废者十之一，以惰而废者十之九</h1>
      
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="search-pop-overlay">
  <div class="popup search-popup">
      <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

  </div>
</div>

  </div>
</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.zuiqiangiron.xyz/2020/04/16/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="嘴强黑铁">
      <meta itemprop="description" content="一顿操作猛如虎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嘴强黑铁">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          R语言入门
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-16 18:30:00" itemprop="dateCreated datePublished" datetime="2020-04-16T18:30:00+08:00">2020-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-21 09:08:54" itemprop="dateModified" datetime="2020-04-21T09:08:54+08:00">2020-04-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/R%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">R语言</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2020/04/16/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/04/16/R语言入门/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>《R语言实战》笔记。</p>
<p>R语言入门内容。</p>
</blockquote>
<a id="more"></a>
<h1 id="写在最前的零散要点">写在最前的零散要点</h1>
<p>可以看完后面的内容再回头来看这些要点。</p>
<ol type="1">
<li>R语言不推荐用等号<code>=</code>来赋值，它会在某些情况下出错，R语言更推荐用<code>&lt;-</code>来表示赋值（它在RStudio和Jupyter Notebook中的快捷键是<code>command + -</code>。</li>
<li>R语言下标从1开始计数，而不像其他语言那样从0开始计数。</li>
<li>变量名称中的句点(<code>.</code>)没有特殊意义，但美元符号(<code>$</code>)却有着和其他语言中的句点类似的含义，即指定一个数据框或列表中的某些部分。例如，<code>A$x</code>是指数据框<code>A</code>中的变量<code>x</code>。</li>
</ol>
<h1 id="新手须知">新手须知</h1>
<p>运算符：</p>
<table>
<thead>
<tr class="header">
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>^</code>或<code>**</code></td>
<td>求幂</td>
</tr>
<tr class="even">
<td><code>x%%y</code></td>
<td>求余。<code>5%%2</code>的结果是1</td>
</tr>
<tr class="odd">
<td><code>x%/%y</code></td>
<td>整数除法。<code>5%/%2</code>的结果是2</td>
</tr>
<tr class="even">
<td><code>x | y</code></td>
<td>或运算</td>
</tr>
<tr class="odd">
<td><code>x &amp; y</code></td>
<td>与运算</td>
</tr>
<tr class="even">
<td><code>isTRUE(x)</code></td>
<td>判断<code>x</code>是否为<code>TRUE</code></td>
</tr>
</tbody>
</table>
<p>以下是新手函数的整理。</p>
<p><strong>帮助相关的函数</strong>：</p>
<table>
<thead>
<tr class="header">
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>help.start()</code></td>
<td>打开帮助文档首页</td>
</tr>
<tr class="even">
<td><code>help("foo”)</code>或<code>?foo</code></td>
<td>查看函数 <code>foo</code> 的帮助(引号可以省略)</td>
</tr>
<tr class="odd">
<td><code>help.search("foo")</code>或<code>??foo</code></td>
<td>以 <code>foo</code> 为关键词搜索本地帮助文档</td>
</tr>
<tr class="even">
<td><code>example("foo")</code></td>
<td>函数 <code>foo</code> 的使用示例(引号可以省略)</td>
</tr>
<tr class="odd">
<td><code>RSiteSearch("foo")</code></td>
<td>以 <code>foo</code> 为关键词搜索在线文档和邮件列表存档</td>
</tr>
<tr class="even">
<td><code>apropos("foo", mode="function")</code></td>
<td>列出名称中含有 <code>foo</code> 的所有可用函数</td>
</tr>
<tr class="odd">
<td><code>data()</code></td>
<td>列出当前已加载包中所含的所有可用示例数据集</td>
</tr>
<tr class="even">
<td><code>vignette()</code></td>
<td>列出当前已安装包中所有可用的 vignette文档</td>
</tr>
<tr class="odd">
<td><code>vignette("foo")</code></td>
<td>为主题 <code>foo</code> 显示指定的 vignette 文档</td>
</tr>
</tbody>
</table>
<p>说明：</p>
<blockquote>
<p>大多数软件包中包含的另一个非常有用的帮助来源是<strong>小品文（Vignettes）</strong>，这些小文件是作者以更详细的方式显示其软件包的一些功能的文档。</p>
</blockquote>
<p><strong>工作空间相关的函数</strong>：</p>
<table>
<thead>
<tr class="header">
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>getwd()</code></td>
<td>查看当前的工作目录</td>
</tr>
<tr class="even">
<td><code>setwd()</code></td>
<td>设定当前的工作目录。反斜杠<code>\</code>转义</td>
</tr>
<tr class="odd">
<td><code>dir.create()</code></td>
<td>创建新目录</td>
</tr>
<tr class="even">
<td><code>ls()</code></td>
<td>列出当前工作空间中的对象</td>
</tr>
<tr class="odd">
<td><code>rm(objectlist)</code></td>
<td>移除(删除)一个或多个对象</td>
</tr>
<tr class="even">
<td><code>help(options)</code></td>
<td>显示可用选项的说明</td>
</tr>
<tr class="odd">
<td><code>options()</code></td>
<td>显示或设置当前选项，例如设置输出图像的长宽，设置小数点的输出位数</td>
</tr>
<tr class="even">
<td><code>history(#)</code></td>
<td>显示最近使用过的<code>#</code>个命令(默认值为 <code>25</code>)</td>
</tr>
<tr class="odd">
<td><code>savehistory("myfile")</code></td>
<td>保存命令历史到文件 <code>myfile</code> 中(默认值为<code>.Rhistory</code>)</td>
</tr>
<tr class="even">
<td><code>loadhistory("myfile")</code></td>
<td>载入一个命令历史文件(默认值为<code>.Rhistory</code>)</td>
</tr>
<tr class="odd">
<td><code>save.image("myfile")</code></td>
<td>保存工作空间到文件 <code>myfile</code> 中(默认值为<code>.RData</code>)</td>
</tr>
<tr class="even">
<td><code>save(objectlist, file="myfile")</code></td>
<td>保存指定对象到一个文件中</td>
</tr>
<tr class="odd">
<td><code>load("myfile")</code></td>
<td>读取一个工作空间到当前会话中(默认值为<code>.RData</code>)</td>
</tr>
</tbody>
</table>
<p>说明：</p>
<blockquote>
<ol type="1">
<li><strong>当前的工作目录(working directory)</strong>是R用来读取文件和保存结果的默认目录。</li>
<li><strong>工作空间(workspace)</strong>就是当前R的工作环境，它存储着所有用户定义的对象(向量、矩阵、 函数、数据框、列表)。</li>
</ol>
</blockquote>
<p><strong>输入输出：</strong></p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr class="header">
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>source(“filename.R”)</code></td>
<td>执行一个R语言脚本（R语言脚本以<code>.R</code>为后缀，但并非必须）</td>
</tr>
<tr class="even">
<td><code>sink(“filename”)</code></td>
<td>将文本输出重定向到文件，默认覆盖原文。<br>参数<code>append=TRUE</code>将输出追加到文件末尾；<br>参数<code>split=TRUE</code>可将输出同时输出到终端和文本。<br>不带任何参数时<code>sink()</code>表示将文本输出重定向回终端。</td>
</tr>
<tr class="odd">
<td><code>bmp("filename.bmp")</code></td>
<td>将图像输出成BMP文件</td>
</tr>
<tr class="even">
<td><code>jpeg("filename.jpg")</code></td>
<td>JPEG 文件</td>
</tr>
<tr class="odd">
<td><code>pdf("filename.pdf")</code></td>
<td>PDF 文件</td>
</tr>
<tr class="even">
<td><code>png("filename.png")</code></td>
<td>PNG 文件</td>
</tr>
<tr class="odd">
<td><code>postscript("filename.ps")</code></td>
<td>PostScript 文件</td>
</tr>
<tr class="even">
<td><code>svg("filename.svg")</code></td>
<td>SVG 文件</td>
</tr>
<tr class="odd">
<td><code>win.metafile("filename.wmf")</code></td>
<td>Windows 图元文件</td>
</tr>
<tr class="even">
<td><code>dev.off()</code></td>
<td>将图片输出重定向到终端</td>
</tr>
</tbody>
</table>
<p>以下是代码示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sink(<span class="string">"myoutput"</span>, append=<span class="literal">TRUE</span>, split=<span class="literal">TRUE</span>)	<span class="comment"># 重定向文本输出到终端和文件</span></span><br><span class="line">pdf(<span class="string">"mygraphs.pdf"</span>)	<span class="comment"># 将图像输出重定向到文件</span></span><br><span class="line"><span class="keyword">source</span>(<span class="string">"script2.R"</span>)	<span class="comment"># 执行R语言脚本</span></span><br><span class="line">sink()	<span class="comment"># 将文本输出重定向到终端</span></span><br><span class="line">dev.off()	<span class="comment"># 将图像输出重定向到终端</span></span><br></pre></td></tr></table></figure>
<p><strong>包相关函数：</strong></p>
<table>
<thead>
<tr class="header">
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>install.packages(“package_name”)</code></td>
<td>安装第三方包，<strong>参数需要带引号</strong></td>
</tr>
<tr class="even">
<td><code>update.packages()</code></td>
<td>更新所有已安装的包</td>
</tr>
<tr class="odd">
<td><code>installed. packages()</code></td>
<td>列出已安装的包</td>
</tr>
<tr class="even">
<td><code>library(package_name)</code></td>
<td>加载第三方包，<strong>参数不能带引号</strong></td>
</tr>
</tbody>
</table>
<h1 id="r语言数据结构">R语言数据结构</h1>
<p>R可以处理的数据类型(模式)包括数值型、字符型、逻辑型(<code>TRUE/FALSE</code>，也就是其他语言中的布尔型)、复数型(虚 数)、原生型(字节)以及因子(factor)。</p>
<blockquote>
<p>对于逻辑型，<code>TRUE</code>可简写为<code>T</code>，<code>FALSE</code>可简写为<code>F</code>。</p>
</blockquote>
<p>在R中，对象(object)是指可以赋值给变量的任何事物，包括常量、数据结构、函数， 甚至图形。</p>
<p>R拥有许多用于存储数据的对象类型，包括标量、向量、矩阵、数组、数据框和列表等。</p>
<h2 id="标量">标量</h2>
<p>标量是只含一个元素的向量，例如<code>f &lt;- 3</code>、<code>g &lt;- "US"</code>和<code>h &lt;- TRUE</code>。它们用于保存常量。相当于其他语言中的一般变量。</p>
<h2 id="向量vector">向量vector</h2>
<p>向量是用于存储数值型、字符型或逻辑型数据的一维数组。执行组合功能的函数<code>c()</code>可用来创建向量：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a &lt;- c(<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">6</span>, -<span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line">b &lt;- c(<span class="string">"one"</span>, <span class="string">"two"</span>, <span class="string">"three"</span>)</span><br><span class="line">c &lt;- c(<span class="literal">TRUE</span>, <span class="literal">TRUE</span>, <span class="literal">TRUE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span>, <span class="literal">FALSE</span>)</span><br></pre></td></tr></table></figure>
<p><strong>单个向量中数据的类型必须相同。</strong></p>
<p>访问向量中的元素：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; a &lt;- c(<span class="string">"k"</span>, <span class="string">"j"</span>, <span class="string">"h"</span>, <span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"m"</span>) </span><br><span class="line"><span class="comment"># 方式1</span></span><br><span class="line">&gt; a[<span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>] <span class="string">"h"</span></span><br><span class="line"><span class="comment"># 方式2</span></span><br><span class="line">&gt; a[c(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>)]</span><br><span class="line">[<span class="number">1</span>] <span class="string">"k"</span> <span class="string">"h"</span> <span class="string">"c"</span></span><br><span class="line"><span class="comment"># 方式3</span></span><br><span class="line">&gt; a[<span class="number">2</span>:<span class="number">6</span>]	<span class="comment"># 冒号生成了一个数值序列，等价于a &lt;- c(2, 3, 4, 5, 6)</span></span><br><span class="line">[<span class="number">1</span>]  <span class="string">"j"</span> <span class="string">"h"</span> <span class="string">"a"</span> <span class="string">"c"</span> <span class="string">"m"</span></span><br></pre></td></tr></table></figure>
<p>给向量中的元素赋值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; a[<span class="number">1</span>] &lt;- <span class="string">"asdf"</span></span><br><span class="line">&gt; a</span><br><span class="line">[<span class="number">1</span>] <span class="string">"asdf"</span> <span class="string">"j"</span>    <span class="string">"h"</span>    <span class="string">"a"</span>    <span class="string">"c"</span>    <span class="string">"m"</span>   </span><br><span class="line"><span class="comment"># 注意此处!</span></span><br><span class="line">&gt; a[<span class="number">10</span>] &lt;- <span class="string">"asdfg"</span></span><br><span class="line">&gt; a</span><br><span class="line"> [<span class="number">1</span>] <span class="string">"asdf"</span>  <span class="string">"j"</span>     <span class="string">"h"</span>     <span class="string">"a"</span>     <span class="string">"c"</span>     <span class="string">"m"</span>     <span class="literal">NA</span>      <span class="literal">NA</span>      <span class="literal">NA</span>      <span class="string">"asdfg"</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<p>将一个值赋给某个向量中一个不存在的元素时，R将自动扩展这个数据结构以容纳新值。后面的矩阵、数组以及列表也一样。</p>
</blockquote>
<h2 id="矩阵matrix">矩阵matrix</h2>
<p>矩阵是一个二维数组，只是每个元素都拥有相同的模式(数值型、字符型或逻辑型)。可通 过函数<code>matrix()</code>创建矩阵。一般使用格式为:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myymatrix &lt;- matrix(vector, nrow=number_of_rows, ncol=number_of_columns, byrow=logical_value, dimnames=list(char_vector_rownames, char_vector_colnames))</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li><code>vector</code>包含了矩阵的元素；</li>
<li><code>nrow</code>和<code>ncol</code>用以指定行和列的维数；</li>
<li><code>dimnames</code>包含了可选的、以字符型向量表示的行名和列名；</li>
<li><code>byrow</code>则表明矩阵应当按行填充(<code>byrow=TRUE</code>) 还是按列填充(<code>byrow=FALSE</code>)，默认情况下按列填充。</li>
</ol>
</blockquote>
<p>以下是创建矩阵和访问矩阵元素的例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; rnames &lt;- c(<span class="string">"R1"</span>, <span class="string">"R2"</span>, <span class="string">"R3"</span>)</span><br><span class="line">&gt; cnames &lt;- c(<span class="string">"C1"</span>, <span class="string">"C2"</span>, <span class="string">"C3"</span>)</span><br><span class="line"><span class="comment"># 创建矩阵，可以只传入nrow和ncol中的一个，R语言会自动计算另一个。</span></span><br><span class="line">&gt; mymatrix &lt;- matrix(cells, nrow = <span class="number">3</span>, byrow = <span class="literal">T</span>, dimnames = list(rnames, cnames))</span><br><span class="line">&gt; mymatrix</span><br><span class="line">   C1 C2 C3</span><br><span class="line">R1  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">R2  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line">R3  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span></span><br><span class="line"><span class="comment"># 访问某行</span></span><br><span class="line">&gt; mymatrix[<span class="number">1</span>,]</span><br><span class="line">C1 C2 C3 </span><br><span class="line"> <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span> </span><br><span class="line"><span class="comment"># 访问某列</span></span><br><span class="line">&gt; mymatrix[,<span class="number">1</span>]</span><br><span class="line">R1 R2 R3 </span><br><span class="line"> <span class="number">1</span>  <span class="number">4</span>  <span class="number">7</span> </span><br><span class="line"><span class="comment"># 访问多行。访问多列同理</span></span><br><span class="line">&gt; mymatrix[<span class="number">1</span>:<span class="number">2</span>,]</span><br><span class="line">   C1 C2 C3</span><br><span class="line">R1  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">R2  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="comment"># 访问某个元素</span></span><br><span class="line">&gt; mymatrix[<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line">[<span class="number">1</span>] <span class="number">4</span></span><br><span class="line"><span class="comment"># 访问多行多列</span></span><br><span class="line">&gt; mymatrix[<span class="number">1</span>:<span class="number">2</span>, c(<span class="number">2</span>, <span class="number">3</span>)]</span><br><span class="line">   C2 C3</span><br><span class="line">R1  <span class="number">2</span>  <span class="number">3</span></span><br><span class="line">R2  <span class="number">5</span>  <span class="number">6</span></span><br><span class="line"><span class="comment"># 按列序访问元素</span></span><br><span class="line">&gt; mymatrix[<span class="number">1</span>:<span class="number">5</span>]</span><br><span class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">4</span> <span class="number">7</span> <span class="number">2</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h2 id="数组array">数组array</h2>
<p>这里的数组array并不同于其他语言中的数组，这里的数组与矩阵类似，但维度可大于2。通过<code>array</code>函数创建，一般形式如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myarray &lt;- array(vector, dimensions, dimnames)</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li><code>vector</code>包含了数组中的数据；</li>
<li><code>dimensions</code>是一个<strong>数值型向量</strong>，给出了各个维度下标的最大值；</li>
<li><code>dimnames</code>是可选的、各维度名称标签的列表；</li>
<li><strong>数组依然要求所有的元素都是同一类型</strong>。</li>
</ol>
</blockquote>
<p>以下是数组示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&gt; dim1 &lt;- c(<span class="string">"A1"</span>, <span class="string">"A2"</span>)</span><br><span class="line">&gt; dim2 &lt;- c(<span class="string">"B1"</span>, <span class="string">"B2"</span>, <span class="string">"B3"</span>)</span><br><span class="line">&gt; dim3 &lt;- c(<span class="string">"C1"</span>, <span class="string">"C2"</span>, <span class="string">"C3"</span>, <span class="string">"C4"</span>)</span><br><span class="line">&gt; z &lt;- array(<span class="number">1</span>:<span class="number">24</span>, c(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>), dimnames = list(dim1, dim2, dim3))</span><br><span class="line">&gt; z</span><br><span class="line">, , C1</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1  <span class="number">1</span>  <span class="number">3</span>  <span class="number">5</span></span><br><span class="line">A2  <span class="number">2</span>  <span class="number">4</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line">, , C2</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1  <span class="number">7</span>  <span class="number">9</span> <span class="number">11</span></span><br><span class="line">A2  <span class="number">8</span> <span class="number">10</span> <span class="number">12</span></span><br><span class="line"></span><br><span class="line">, , C3</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1 <span class="number">13</span> <span class="number">15</span> <span class="number">17</span></span><br><span class="line">A2 <span class="number">14</span> <span class="number">16</span> <span class="number">18</span></span><br><span class="line"></span><br><span class="line">, , C4</span><br><span class="line"></span><br><span class="line">   B1 B2 B3</span><br><span class="line">A1 <span class="number">19</span> <span class="number">21</span> <span class="number">23</span></span><br><span class="line">A2 <span class="number">20</span> <span class="number">22</span> <span class="number">24</span></span><br></pre></td></tr></table></figure>
<p><strong>数组取元素的方式和矩阵相同</strong>，只不过要加上其他维度。</p>
<h2 id="数据框data.frame">数据框data.frame</h2>
<p>数据框的概念较矩阵来说更为一般，它允许不同列的元素的数据类型可以不同，但列中元素的数据类型必须相同。</p>
<p>数据框通过函数<code>data.frame()</code>创建：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mydata &lt;- data.frame(col1, col2, col3,<span class="keyword">...</span>, row.names=coln)</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<p><code>row.names</code>用于将数据框中的某一列设置为<strong>实例标识符</strong>。</p>
</blockquote>
<p>以下是创建数据框和访问数据框中数据的例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&gt; patientID &lt;- c(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">&gt; age &lt;- c(<span class="number">25</span>, <span class="number">34</span>, <span class="number">28</span>, <span class="number">52</span>)</span><br><span class="line">&gt; diabetes &lt;- c(<span class="string">"Type1"</span>, <span class="string">"Type2"</span>, <span class="string">"Type1"</span>, <span class="string">"Type1"</span>)</span><br><span class="line">&gt; status &lt;- c(<span class="string">"Poor"</span>, <span class="string">"Improved"</span>, <span class="string">"Excellent"</span>, <span class="string">"Poor"</span>)</span><br><span class="line"><span class="comment"># 创建数据框</span></span><br><span class="line">&gt; patientdata &lt;- data.frame(patientID, age, diabetes, status)</span><br><span class="line">&gt; patientdata</span><br><span class="line">  patientID age diabetes    status</span><br><span class="line"><span class="number">1</span>         <span class="number">1</span>  <span class="number">25</span>    Type1      Poor</span><br><span class="line"><span class="number">2</span>         <span class="number">2</span>  <span class="number">34</span>    Type2  Improved</span><br><span class="line"><span class="number">3</span>         <span class="number">3</span>  <span class="number">28</span>    Type1 Excellent</span><br><span class="line"><span class="number">4</span>         <span class="number">4</span>  <span class="number">52</span>    Type1      Poor</span><br><span class="line"><span class="comment"># 上述输出中，patientID前的那一列是R语言自动生成的实例标识符</span></span><br><span class="line"><span class="comment"># 以下语句用于自行制定实例标识符：</span></span><br><span class="line"><span class="comment"># patientdata &lt;- data.frame(patientID, age, diabetes, status, row.names = patientID)</span></span><br><span class="line"><span class="comment"># 访问单个元素</span></span><br><span class="line">&gt; patientdata[<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">[<span class="number">1</span>] <span class="number">25</span></span><br><span class="line"><span class="comment"># 访问前两列</span></span><br><span class="line">&gt; patientdata[<span class="number">1</span>:<span class="number">2</span>]</span><br><span class="line">  patientID age</span><br><span class="line"><span class="number">1</span>         <span class="number">1</span>  <span class="number">25</span></span><br><span class="line"><span class="number">2</span>         <span class="number">2</span>  <span class="number">34</span></span><br><span class="line"><span class="number">3</span>         <span class="number">3</span>  <span class="number">28</span></span><br><span class="line"><span class="number">4</span>         <span class="number">4</span>  <span class="number">52</span></span><br><span class="line"><span class="comment"># 访问多列</span></span><br><span class="line">&gt; patientdata[c(<span class="string">"diabetes"</span>, <span class="string">"status"</span>)]</span><br><span class="line">  diabetes    status</span><br><span class="line"><span class="number">1</span>    Type1      Poor</span><br><span class="line"><span class="number">2</span>    Type2  Improved</span><br><span class="line"><span class="number">3</span>    Type1 Excellent</span><br><span class="line"><span class="number">4</span>    Type1      Poor</span><br><span class="line"><span class="comment"># 访问单列</span></span><br><span class="line">&gt; patientdata$age</span><br><span class="line">[<span class="number">1</span>] <span class="number">25</span> <span class="number">34</span> <span class="number">28</span> <span class="number">52</span></span><br></pre></td></tr></table></figure>
<p>上述例子最后的<code>$</code>符号表示<strong>选取一个给定数据框中的某个特定变量(列)</strong>。</p>
<h3 id="attachdetach和with"><strong>attach()</strong>、<strong>detach()</strong>和<strong>with()</strong></h3>
<p>以上述例子为例，对于数据框，如果每次都用<code>patientdata$</code>来访问其中的变量未免太麻烦，此时就可以使用<code>attach()</code>，<code>detach()</code>和<code>with()</code>函数来简化操作。</p>
<p>函数<code>attach()</code>可将数据框添加到R的搜索路径中。R在遇到一个变量名后，将检查搜索路径中的数据框。</p>
<p>函数<code>detach()</code>将数据框从搜索路径中移除。<strong>这句通常被省略，但最好在处理完一个数据框后加上这句话，否则很容易造成名称冲突</strong>。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将数据框中的变量加入搜索路径</span></span><br><span class="line"><span class="keyword">attach</span>(mtcars)</span><br><span class="line">summary(mpg)</span><br><span class="line">plot(mpg, disp)</span><br><span class="line">plot(mpg, wt)</span><br><span class="line"><span class="comment"># 最好加上这句，否则很容易造成名称冲突</span></span><br><span class="line"><span class="keyword">detach</span>(mtcars)	<span class="comment"># 将数据框从搜索路径去除</span></span><br><span class="line"></span><br><span class="line">with(mtcars, &#123;</span><br><span class="line">    print(summary(mpg))</span><br><span class="line">	plot(mpg, disp)</span><br><span class="line">	plot(mpg, wt)</span><br><span class="line">    <span class="comment"># 只能在当前作用域内访问</span></span><br><span class="line">    nokeepstats &lt;- summary(mpg)</span><br><span class="line">    <span class="comment"># 可以在外部作用域内访问</span></span><br><span class="line">    keepstats &lt;&lt;- summary(mpg)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">keepstats <span class="comment"># 可以访问</span></span><br><span class="line">nokeepstats	<span class="comment"># 报错，全局作用域中没有该变量</span></span><br></pre></td></tr></table></figure>
<p><code>with()</code>可以很好解决名称冲突的问题，更推荐使用这个函数。不过，<code>with()</code>内部的变量在外部无法访问，如果想要外部可以访问，需要使用<code>&lt;&lt;-</code>赋值语句。</p>
<h2 id="因子factor">因子factor</h2>
<p>首先需要介绍一下变量的类型：</p>
<ul>
<li>名义型变量：例如性别，只有类别之分，没有高低先后之分；</li>
<li>有序型变量：表示了一种顺序关系，而非数量关系，例如年级；</li>
<li>连续型变量：可以呈现出某个范围内的任意值，同时还表示了顺序和数量，例如年龄。</li>
</ul>
<p>名义型变量和有序型变量在R中则称为因子(factor)。</p>
<p>它等价于其他语言里的枚举类型。</p>
<p>函数<code>factor()</code>以一个整数向量的形式存储类别值，整数的取值范围是<code>[1,k]</code> (其中<code>k</code>是名义型变量中不同值的个数)，同时内部维护了一个映射表，将这些整数与类别字符串一一对应。</p>
<p>默认情况下，<code>factor()</code>将按字母序赋值。</p>
<p>以下是名义型变量的例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; diabetes &lt;- c(<span class="string">"Type1"</span>, <span class="string">"Type2"</span>, <span class="string">"Type1"</span>, <span class="string">"Type1"</span>)</span><br><span class="line">&gt; diabetes &lt;- factor(diabetes)</span><br><span class="line">&gt; diabetes</span><br><span class="line">[<span class="number">1</span>] Type1 Type2 Type1 Type1</span><br><span class="line">Levels: Type1 Type2</span><br><span class="line"><span class="comment"># diabetes只是一个普通的Factor</span></span><br><span class="line">&gt; str(diabetes)</span><br><span class="line"> Factor w/ <span class="number">2</span> levels <span class="string">"Type1"</span>,<span class="string">"Type2"</span>: <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li>向量<code>diabetes</code>将被存储为<code>(1, 2, 1, 1)</code>，并在内部将其关联为<code>1=Type1</code>和<code>2=Type2</code>;</li>
<li><code>str()</code>函数用于显示对象的结构。</li>
</ol>
</blockquote>
<p>以下是有序型变量的例子，<code>factor()</code>将参数<code>ordered</code>设置为<code>TRUE</code>即可：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; status &lt;- c(<span class="string">"Poor"</span>, <span class="string">"Improved"</span>, <span class="string">"Excellent"</span>, <span class="string">"Poor"</span>)</span><br><span class="line"><span class="comment"># 根据字母序设置类别先后顺序: 1=Excellent, 2=Improved, 3=Poor</span></span><br><span class="line">&gt; status &lt;- factor(status, ordered=<span class="literal">TRUE</span>)</span><br><span class="line"><span class="comment"># status是一个Ord.factor</span></span><br><span class="line">&gt; str(status)</span><br><span class="line"> Ord.factor w/ <span class="number">3</span> levels <span class="string">"Excellent"</span>&lt;<span class="string">"Improved"</span>&lt;..: <span class="number">3</span> <span class="number">2</span> <span class="number">1</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>因子函数将按照字母序设置这三个类别的顺序。但很多时候我们想要自行指定先后顺序，此时需要设置<code>levels</code>参数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自定义类别的先后顺序: 1=Poor, 2=Improved, 3=Excellent</span></span><br><span class="line">&gt; status &lt;- factor(status, order=<span class="literal">TRUE</span>, levels=c(<span class="string">"Poor"</span>, <span class="string">"Improved"</span>, <span class="string">"Excellent"</span>))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：任何在数据中出现而未在<code>levels</code>中列举的数据都将被设为缺失值<code>NA</code>。</p>
</blockquote>
<p>以上例子都是将字符或字符串型数据因子话，数值型变量也可以因子化，并同时给数值设置标签，例如，原始数据中<code>sex</code>的值就是<code>1</code>或者<code>2</code>这样的数值，而不是<code>male</code>或者<code>female</code>这样的字符串，现在我们想将<code>sex</code>因子化，并同时将<code>1</code>替换成<code>male</code>，<code>2</code>替换成<code>female</code>，此时可以这样做：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; sex &lt;- c(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">&gt; sex</span><br><span class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line">&gt; sex &lt;- factor(sex, levels=c(<span class="number">1</span>, <span class="number">2</span>), labels=c(<span class="string">"Male"</span>, <span class="string">"Female"</span>))</span><br><span class="line">&gt; sex</span><br><span class="line">[<span class="number">1</span>] Male   Female Male   Female Male   Female</span><br><span class="line">Levels: Male Female</span><br><span class="line"><span class="comment"># sex也只是一个普通的Factor</span></span><br><span class="line">&gt; str(sex)</span><br><span class="line"> Factor w/ <span class="number">2</span> levels <span class="string">"Male"</span>,<span class="string">"Female"</span>: <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span> <span class="number">1</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h2 id="列表">列表</h2>
<p>类似于Python中的<code>List</code>类型，它就是一些对象(或成分 component)的有序集合。列表可以整合若干(可能无关的)对象到单个对象中。也就是说，列表中的对象的类型可以不同：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mylist &lt;- list(object1, object2, <span class="keyword">...</span>)</span><br><span class="line"><span class="comment"># 可以给列表中的元素命名，并且可以只命名一部分</span></span><br><span class="line">mylist &lt;- list(name1=object1, name2=object2, <span class="keyword">...</span>)</span><br></pre></td></tr></table></figure>
<p>以下是列表创建和访问列表中元素的例子:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt; g &lt;- <span class="string">"My First List"</span></span><br><span class="line">&gt; h &lt;- c(<span class="number">25</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">39</span>)</span><br><span class="line">&gt; j &lt;- matrix(<span class="number">1</span>:<span class="number">10</span>, nrow=<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 只命名前两个元素</span></span><br><span class="line">&gt; mylist &lt;- list(title=g, ages=h, j)</span><br><span class="line">&gt; mylist</span><br><span class="line">$title</span><br><span class="line">[<span class="number">1</span>] <span class="string">"My First List"</span></span><br><span class="line"></span><br><span class="line">$ages</span><br><span class="line">[<span class="number">1</span>] <span class="number">25</span> <span class="number">26</span> <span class="number">18</span> <span class="number">39</span></span><br><span class="line"></span><br><span class="line">[[<span class="number">3</span>]]</span><br><span class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>]</span><br><span class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">6</span></span><br><span class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">7</span></span><br><span class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">8</span></span><br><span class="line">[<span class="number">4</span>,]    <span class="number">4</span>    <span class="number">9</span></span><br><span class="line">[<span class="number">5</span>,]    <span class="number">5</span>   <span class="number">10</span></span><br><span class="line"><span class="comment"># 通过双中括号访问列表中的元素</span></span><br><span class="line">&gt; mylist[[<span class="string">"ages"</span>]]</span><br><span class="line">[<span class="number">1</span>] <span class="number">25</span> <span class="number">26</span> <span class="number">18</span> <span class="number">39</span></span><br><span class="line">&gt; mylist[[<span class="number">2</span>]]</span><br><span class="line">[<span class="number">1</span>] <span class="number">25</span> <span class="number">26</span> <span class="number">18</span> <span class="number">39</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li>通过双中括号访问列表中的元素；</li>
<li>可以通过设置的元素名访问元素，也可以通过下标访问元素。</li>
</ol>
</blockquote>
<h2 id="一些处理数据对象的实用函数">一些处理数据对象的实用函数</h2>
<table>
<thead>
<tr class="header">
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>length(object)</code></td>
<td>获取对象中元素/成分的数量</td>
</tr>
<tr class="even">
<td><code>dim(object)</code></td>
<td>显示某个对象的维度</td>
</tr>
<tr class="odd">
<td><code>str(object)</code></td>
<td>显示某个对象的结构</td>
</tr>
<tr class="even">
<td><code>class(object)</code></td>
<td>显示某个对象的类或类型</td>
</tr>
<tr class="odd">
<td><code>typeof(object)</code></td>
<td>详细显示某个对象的模式</td>
</tr>
<tr class="even">
<td><code>names(object)</code></td>
<td>显示某对象中各成分的名称</td>
</tr>
<tr class="odd">
<td><code>c(object, object,...)</code></td>
<td>将对象合并入一个向量</td>
</tr>
<tr class="even">
<td><code>cbind(object, object, ...)</code></td>
<td>按列合并对象</td>
</tr>
<tr class="odd">
<td><code>rbind(object, object, ...)</code></td>
<td>按行合并对象</td>
</tr>
<tr class="even">
<td><code>head(object)</code></td>
<td>列出某个对象的开始部分</td>
</tr>
<tr class="odd">
<td><code>tail(object)</code></td>
<td>列出某个对象的最后部分</td>
</tr>
<tr class="even">
<td><code>ls()</code></td>
<td>显示当前的对象列表</td>
</tr>
<tr class="odd">
<td><code>rm(object, object, ...)</code></td>
<td>删除一个或更多个对象。<br>语句<code>rm(list = ls())</code>将 删除当前工作环境中的几乎所有对象</td>
</tr>
</tbody>
</table>
<p>这里有一个关于<code>class()</code>和<code>typeof()</code>区别的<a href="https://stackoverflow.com/questions/8855589/a-comprehensive-survey-of-the-types-of-things-in-r-mode-and-class-and-type" target="_blank" rel="noopener">介绍</a>，简单来说，<code>typeof()</code>返回对象的数据类型（就像Python中的<code>type()</code>函数函数），而<code>class()</code>只是检查某个对象里有没有<code>class</code>这个属性，如果有就返回这个属性的值，如果没有这个属性，则根据对象的类型和维度来确定。</p>
<h1 id="数据的输入">数据的输入</h1>
<p>R可从键盘、文本文件、Microsoft Excel和Access、流行的统计软件、特殊格 式的文件、多种关系型数据库管理系统、专业数据库、网站和在线服务中导入数据。</p>
<p>这里将详细说明如何从文本文件中读取数据，以及简要介绍如何从键盘和Excel中读入数据。</p>
<h2 id="从带分隔符的文件读入数据">从带分隔符的文件读入数据</h2>
<p>主要是两个函数：<code>read.table()</code>和<code>read.csv()</code>。</p>
<p><code>read.table()</code>是通用的读取带分隔符文本的函数，后者主要用于读取以逗号分隔的<code>.csv</code>文件。</p>
<p><code>read.table()</code>的调用方式如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mydataframe &lt;- read.table(file, options)</span><br></pre></td></tr></table></figure>
<p>主要的<code>options</code>如下表所示：</p>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>header</code></td>
<td>一个表示文件是否在第一行包含了变量名的逻辑型变量</td>
</tr>
<tr class="even">
<td><code>sep</code></td>
<td>分开数据值的分隔符。默认是<code>sep=""</code>，这表示了一个或多个空格、制表符、换行或回车。使用<code>sep=","</code>来读取用逗号来分隔行内数据的文件，使用<code>sep="\t"</code>来读取使用制表符来分割行内数据的文件</td>
</tr>
<tr class="odd">
<td><code>row.names</code></td>
<td>一个用于指定一个或多个行标记符的可选参数</td>
</tr>
<tr class="even">
<td><code>col.names</code></td>
<td>如果数据文件的第一行不包括变量名(<code>header=FASLE</code>)，可以用 <code>col.names</code> 去指定一个包含变量名的字符向量。如果 <code>header=FALSE</code> 以及 <code>col.names</code> 选项被省略了，变量会被分别命名为 <code>V1</code>、<code>V2</code>，以此类推</td>
</tr>
<tr class="odd">
<td><code>na.strings</code></td>
<td>可选的用于表示缺失值的字符向量。比如说，<code>na.strings=c("-9", "?")</code>把<code>-9</code> 和<code>?</code>值在读取数据的时候转换成<code>NA</code></td>
</tr>
<tr class="even">
<td><code>colClasses</code></td>
<td>可选的分配到每一列的类向量。比如说，<code>colClasses=c("numeric", "numeric", "character", "NULL", "numeric")</code>把前两列读取为数值型变量，把第三列读取为字符型向量，跳过第四列，把第五列读取为数值型向量。如果数据有多余五列，<code>colClasses</code> 的值会被循环。当读取大文件时，加上 <code>colClasses</code> 选项可以明显提升读取速度</td>
</tr>
<tr class="odd">
<td><code>quote</code></td>
<td>默认情况下，字符串可以被 <code>"</code> 或 <code>'</code> 括起，并且两种情况下，引号内部的字符都作为字符串的一部分。有效的引用字符（可能没有）的设置由参数 <code>quote</code> 控制。对于<code>sep = "\n"</code>，默认值改为 <code>quote = ""</code>。</td>
</tr>
<tr class="even">
<td><code>skip</code></td>
<td>读取数据前跳过的行的数目。这个选项在跳过头注释的时候比较有用</td>
</tr>
<tr class="odd">
<td><code>stringsAsFactors</code></td>
<td>一个逻辑变量，标记处字符向量是否需要转化成因子。默认值是 <code>TRUE</code>，除非它被 <code>colClases</code> 所覆盖。当处理大文件时，置为 <code>FALSE</code> 可以提升读取速度</td>
</tr>
<tr class="even">
<td><code>text</code></td>
<td>它的值是一个字符串，表示将从该字符串中读取数据。如果 <code>text</code> 被设置了，<code>file</code>参数必须置为空。</td>
</tr>
</tbody>
</table>
<p>以下是<code>read.table()</code>的一个例子，假设数据文件中的内容人如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">StudentID,First,Last,Math,Science,Social Studies</span><br><span class="line"><span class="number">011</span>,Bob,Smith,<span class="number">90</span>,<span class="number">80</span>,<span class="number">67</span></span><br><span class="line"><span class="number">012</span>,Jane,Weary,<span class="number">75</span>,,<span class="number">80</span></span><br><span class="line"><span class="number">010</span>,Dan,<span class="string">"Thornton, III"</span>,<span class="number">65</span>,<span class="number">75</span>,<span class="number">70</span> <span class="comment"># 这里就体现了quote参数的作用，否则这条数据将会被读取为7列</span></span><br><span class="line"><span class="number">040</span>,Mary,<span class="string">"O'Leary"</span>,<span class="number">90</span>,<span class="number">95</span>,<span class="number">92</span></span><br></pre></td></tr></table></figure>
<p>以下是读取代码：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt; grades &lt;- read.table(<span class="string">"studentgrades.csv"</span>, header=<span class="literal">TRUE</span>, row.names=<span class="string">"StudentID"</span>, sep=<span class="string">","</span>)</span><br><span class="line">&gt; grades</span><br><span class="line">   First          Last Math Science Social.Studies</span><br><span class="line"><span class="number">11</span>   Bob         Smith   <span class="number">90</span>      <span class="number">80</span>             <span class="number">67</span></span><br><span class="line"><span class="number">12</span>  Jane         Weary   <span class="number">75</span>      <span class="literal">NA</span>             <span class="number">80</span></span><br><span class="line"><span class="number">10</span>   Dan Thornton, III   <span class="number">65</span>      <span class="number">75</span>             <span class="number">70</span></span><br><span class="line"><span class="number">40</span>  Mary       O<span class="string">'Leary   90      95             92</span></span><br><span class="line"><span class="string"># R语言会自动判断每列的数据类型</span></span><br><span class="line"><span class="string">&gt; str(grades)</span></span><br><span class="line"><span class="string">'</span>data.frame<span class="string">':	4 obs. of  5 variables:</span></span><br><span class="line"><span class="string"> $ First         : Factor w/ 4 levels "Bob","Dan","Jane",..: 1 3 2 4</span></span><br><span class="line"><span class="string"> $ Last          : Factor w/ 4 levels "O'</span>Leary<span class="string">","</span>Smith<span class="string">",..: 2 4 3 1</span></span><br><span class="line"><span class="string"> $ Math          : int  90 75 65 90</span></span><br><span class="line"><span class="string"> $ Science       : int  80 NA 75 95</span></span><br><span class="line"><span class="string"> $ Social.Studies: int  67 80 70 92</span></span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li>由于设置了<code>row.names</code>，数据中并没有显示<code>StudentID</code>这一列；</li>
<li>由于没有设置<code>colClasses</code>，<code>StudentID</code>这一列被判断成了数值型，原数据中最前面的0被去除了；</li>
<li>默认情况下，字符变量将被转换成因子，例如上述的<code>First</code>和<code>Last</code>；</li>
<li><code>read.table()</code>函数会自动判断每列的数据类型，但有时候自动判断出的类型并不一定是我们想要的。</li>
</ol>
</blockquote>
<p>以下通过设置<code>colClasses</code>参数来设置每列的数据类型：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; grades &lt;- read.table(<span class="string">"studentgrades.csv"</span>, header=<span class="literal">TRUE</span>, row.names=<span class="string">"StudentID"</span>, sep=<span class="string">","</span>, colClasses=c(<span class="string">"character"</span>, <span class="string">"character"</span>, <span class="string">"character"</span>, <span class="string">"numeric"</span>, <span class="string">"numeric"</span>, <span class="string">"numeric"</span>))</span><br><span class="line"></span><br><span class="line">&gt; grades</span><br><span class="line">    First          Last Math Science Social.Studies</span><br><span class="line"><span class="number">011</span>   Bob         Smith   <span class="number">90</span>      <span class="number">80</span>             <span class="number">67</span></span><br><span class="line"><span class="number">012</span>  Jane         Weary   <span class="number">75</span>      <span class="literal">NA</span>             <span class="number">80</span></span><br><span class="line"><span class="number">010</span>   Dan Thornton, III   <span class="number">65</span>      <span class="number">75</span>             <span class="number">70</span></span><br><span class="line"><span class="number">040</span>  Mary       O<span class="string">'Leary   90      95             92</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; str(grades)</span></span><br><span class="line"><span class="string">'</span>data.frame<span class="string">':	4 obs. of  5 variables:</span></span><br><span class="line"><span class="string"> $ First         : chr  "Bob" "Jane" "Dan" "Mary"</span></span><br><span class="line"><span class="string"> $ Last          : chr  "Smith" "Weary" "Thornton, III" "O'</span>Leary<span class="string">"</span></span><br><span class="line"><span class="string"> $ Math          : num  90 75 65 90</span></span><br><span class="line"><span class="string"> $ Science       : num  80 NA 75 95</span></span><br><span class="line"><span class="string"> $ Social.Studies: num  67 80 70 92</span></span><br></pre></td></tr></table></figure>
<p>可以看到，行标识符变成了三位数，保留了最高位的0。<code>First</code>和<code>Last</code>的类型也变成了字符型。</p>
<h3 id="read.csv函数">read.csv()函数</h3>
<p>该函数主要用于读取<code>.csv</code>文件。它的参数和<code>read.table()</code>的参数几乎相同，只是改变了其中某些参数的默认值，例如<code>seq</code>的默认值变成了逗号<code>,</code>，<code>quote</code>的默认值变成了<code>\”</code>，因此在调用该函数时，某些参数可以省略，除此之外，它的用法几乎和<code>read.table()</code>一样，这里不再赘述。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; grades &lt;- read.csv(<span class="string">"studentgrades.csv"</span>, row.names=<span class="string">"StudentID"</span>, colClasses=c(<span class="string">"character"</span>, <span class="string">"character"</span>, <span class="string">"character"</span>, <span class="string">"numeric"</span>, <span class="string">"numeric"</span>, <span class="string">"numeric"</span>))</span><br></pre></td></tr></table></figure>
<h2 id="从键盘读入数据">从键盘读入数据</h2>
<p>主要是调用<code>edit()</code>和<code>fix()</code>函数。调用这两个函数需要安装第三方库<code>XQuartz</code>。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; mydata &lt;- data.frame(age=numeric(<span class="number">0</span>), gender=character(<span class="number">0</span>), weight=numeric(<span class="number">0</span>))</span><br><span class="line">&gt; mydata &lt;- edit(mydata)</span><br><span class="line"><span class="comment"># 等价写法</span></span><br><span class="line">&gt; fix(mydata)</span><br></pre></td></tr></table></figure>
<p>调用<code>edit()</code>函数将会弹出一个列表编辑器，在其中输入值即可。</p>
<h2 id="读取excel文件">读取Excel文件</h2>
<p>读取Excel文件最好的方法其实是将其导出为<code>.csv</code>文件，然后调用<code>read.csv()</code>。</p>
<p>如果要直接读取Excel文件，需要安装第三方库，例如<code>xlsx</code>。用法如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(xlsx)</span><br><span class="line">workbook &lt;- <span class="string">"c:/myworkbook.xlsx"</span></span><br><span class="line"><span class="comment"># 表示读取文件中的第1个工作表</span></span><br><span class="line">mydataframe &lt;- read.xlsx(workbook, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h1 id="图形初阶">图形初阶</h1>
<p>以下内容将主要以散点图<code>plot()</code>为例。</p>
<p>初始数据如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dose &lt;- c(<span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">45</span>, <span class="number">60</span>)</span><br><span class="line">drugA &lt;- c(<span class="number">16</span>, <span class="number">20</span>, <span class="number">27</span>, <span class="number">40</span>, <span class="number">60</span>)</span><br><span class="line">drugB &lt;- c(<span class="number">15</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">31</span>, <span class="number">40</span>)</span><br></pre></td></tr></table></figure>
<h2 id="散点图">散点图</h2>
<p>使用R自带的<code>plot()</code>函数即可生成散点图。但直接传入x和y，画出来的图像将非常简陋，往往我们需要设置诸多参数来得到更好的效果。</p>
<p>有两种方式设置图像参数：</p>
<ul>
<li>直接在绘图函数中设置相应的参数；</li>
<li>通过<code>par()</code>函数设置图像参数，它设置的是全局的图像参数。<code>par()</code>中设置的参数，除非被再次修改，否则将在会话结束前一直有效。直接执行<code>par()</code>将生成一个含有当前图形参数设置的列表。 添加参数 <code>no.readonly=TRUE</code>可以生成一个可以修改的当前图形参数列表。一般用这种方式保留原始图像参数配置。</li>
</ul>
<p>由于两种方法中的参数几乎都是同名的，所以这里结合起来演示。</p>
<p>以下是设置了诸多参数后的示例代码，稍后会有详细讲解：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">1</span>:<span class="number">10</span>)</span><br><span class="line">y &lt;- x</span><br><span class="line">z &lt;- <span class="number">10</span>/x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存初始图像设置</span></span><br><span class="line">opar &lt;- par(no.readonly = <span class="literal">TRUE</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置全局图像的尺寸，边界和其中的字体</span></span><br><span class="line">par(pin = c(<span class="number">4</span>, <span class="number">3</span>), mar = c(<span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>) + <span class="number">0.1</span>, family = <span class="string">"mono"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制散点图，同时设置该图像（非全局图像）的点类型，线类型，点线的颜色，坐标的颜色，是否显示y轴，是否显示标题，以及x轴的范围</span></span><br><span class="line">plot(x, y, type = <span class="string">"b"</span>, pch = <span class="number">21</span>, lty = <span class="number">3</span>, col = <span class="string">"red"</span>, col.axis = <span class="string">"orange"</span>, yaxt = <span class="string">"n"</span>, </span><br><span class="line">     ann = <span class="literal">FALSE</span>, xlim = c(-<span class="number">1</span>, <span class="number">11</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加一条线到当前图像中，同时设置点线的类型颜色</span></span><br><span class="line">lines(x, z, type = <span class="string">"b"</span>, pch = <span class="number">22</span>, col = <span class="string">"blue"</span>, lty = <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置左方的y轴，at表示需要绘制刻度线的位置，labels表示刻度值（与at一一对应），</span></span><br><span class="line"><span class="comment"># las表示标签是否平行于坐标轴，font.axis表示刻度文字的大小</span></span><br><span class="line">axis(<span class="number">2</span>, at = x, labels = x, col.axis = <span class="string">"red"</span>, las = <span class="number">2</span>, font.axis = <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置右方的y轴，tck表示刻度线的长度</span></span><br><span class="line">axis(<span class="number">4</span>, at = z, labels = round(z, digits = <span class="number">2</span>), col.axis = <span class="string">"blue"</span>, las = <span class="number">2</span>, </span><br><span class="line">     cex.axis = <span class="number">0.7</span>, tck = -<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># margin</span></span><br><span class="line"><span class="comment"># text的缩写，用于在图像的四周添加文字，此处是在右边添加文字，line用于控制边距</span></span><br><span class="line">mtext(<span class="string">"y=1/x"</span>, side = <span class="number">4</span>, line = <span class="number">3</span>, cex.lab = <span class="number">1</span>, las = <span class="number">2</span>, col = <span class="string">"blue"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加标题，main是上方的主标题，sub是下方的副标题，xlab值x轴标签，ylab指y轴标签，</span></span><br><span class="line"><span class="comment"># font.main指主标题字体大小，font.sub指副标题字体大小</span></span><br><span class="line">title(main = <span class="string">"An Example of Creative Axes"</span>, sub = <span class="string">"This is a test for image config"</span>, </span><br><span class="line">      xlab = <span class="string">"X values"</span>, ylab = <span class="string">"Y=X"</span>, col.lab = <span class="string">"purple"</span>, col.main = <span class="string">"orange"</span>, </span><br><span class="line">      col.sub = <span class="string">"orange"</span>, font.main = <span class="number">2</span>, font.sub = <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加参考线，h参数指纵轴参考线，v参数指横轴参考线</span></span><br><span class="line">abline(h = c(<span class="number">5</span>), lwd = <span class="number">1.5</span>, lty = <span class="number">2</span>, col = <span class="string">"gray"</span>)</span><br><span class="line">abline(v = c(<span class="number">6</span>), lwd = <span class="number">1.5</span>, lty = <span class="number">3</span>, col = <span class="string">"gray"</span>)</span><br><span class="line"><span class="comment"># 添加一条拟合出的直线，也可以是曲线</span></span><br><span class="line">abline(lm(z ~ x), col = <span class="string">"gray"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加图例，legend指图例说明，lty指线的类型，pch指点的类型，这确保这3个参数对应正确</span></span><br><span class="line">legend(<span class="string">"topleft"</span>, inset = <span class="number">0.05</span>, title = <span class="string">"Function"</span>, legend = c(<span class="string">"Y=X"</span>, <span class="string">"Y=1/X"</span>), </span><br><span class="line">       lty = c(<span class="number">3</span>, <span class="number">2</span>), pch = c(<span class="number">21</span>, <span class="number">22</span>), col = c(<span class="string">"red"</span>, <span class="string">"blue"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复初始图像设置</span></span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure>
<p>以下是绘制出的图像：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587272016/R/散点图2.png" /></p>
<p>上述代码中设计到了如下诸多内容：</p>
<ul>
<li>点的形状和线条的样式；</li>
<li>文字与图像的缩放尺度；</li>
<li>文字与图像的颜色；</li>
<li>字体样式；</li>
<li>图形尺寸和边界尺寸；</li>
<li>自定义坐标轴；</li>
<li>图例；</li>
<li>添加新的直线曲线；</li>
<li>文本添加。</li>
</ul>
<p>以下是它们的具体介绍，下方的参数并不局限于某个函数，在诸多绘图函数中都可以设置这些参数（但并不是所有的绘图函数都包含以下所有的参数，并且，某些参数在不同的函数中，效果略有差别）。</p>
<h3 id="点线的形状">点线的形状</h3>
<p>具体参数如下：</p>
<table>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pch</code></td>
<td>指定绘制点时使用的符号。</td>
</tr>
<tr class="even">
<td><code>cex</code></td>
<td>指定符号的大小。<code>cex</code>是一个数值，表示绘图符号相对于默认大小的缩放倍数。<br />同时它还能控制文字的缩放。</td>
</tr>
<tr class="odd">
<td><code>lty</code></td>
<td>指定线条类型。</td>
</tr>
<tr class="even">
<td><code>lwd</code></td>
<td>指定线条宽度。与<code>cex</code>同理，<code>lwd</code>也是以默认值的倍数来表示的。</td>
</tr>
</tbody>
</table>
<p><code>pch</code>的示例图如下：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587273485/R/pch.png" /></p>
<p><code>lty</code>的示例图如下：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587273485/R/lty.png" /></p>
<h3 id="颜色">颜色</h3>
<p>以下是与颜色相关的参数：</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>col</code></td>
<td>默认的绘图颜色。某些函数(如 <code>lines</code> 和 <code>pie</code>)可以接受一个含有颜色值的向量并自动循环使用。 例如，如果设定 <code>col=c("red", "blue")</code>并需要绘制三条线，则第一条线将为红色，第二条线为蓝色，第三条线又将为红色</td>
</tr>
<tr class="even">
<td><code>col.axis</code></td>
<td>坐标轴刻度上文字的颜色</td>
</tr>
<tr class="odd">
<td><code>col.lab</code></td>
<td>坐标轴标签(也就是x轴y轴的名称)的颜色</td>
</tr>
<tr class="even">
<td><code>col.main</code></td>
<td>标题颜色</td>
</tr>
<tr class="odd">
<td><code>col.sub</code></td>
<td>副标题颜色</td>
</tr>
<tr class="even">
<td><code>fg</code></td>
<td>图形的前景色</td>
</tr>
<tr class="odd">
<td><code>bg</code></td>
<td>图形的背景色</td>
</tr>
</tbody>
</table>
<p>在R中，可以通过颜色下标、颜色名称、十六进制的颜色值、RGB值或HSV值来指定颜色。例如白色可以用以下几种方式来表示：<code>col=1</code>、<code>col="white"</code>、<code>col="#FFFFFF"</code>、<code>col=rgb(1,1,1)</code>和<code>col=hsv(0,0,1)</code>。</p>
<p>函数<code>colors()</code>可以获取所有可用颜色的名称。</p>
<p>创建颜色向量可以使用第三方库<code>RColorBrewer</code>：<code>brewer.pal(n, "Set1")</code>，该行代码表示从调色板<code>Set1</code>中创建一个长度为<code>n</code>的颜色向量。</p>
<p>灰度可以用自带的<code>gray()</code>函数来生成，参数的取值范围为<code>[0, 1]</code>。</p>
<h3 id="文本字体与大小">文本字体与大小</h3>
<table>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>font</code></td>
<td>整数。用于指定绘图使用的字体样式。<code>1=常规</code>，<code>2=粗体</code>，<code>3=斜体</code>，<code>4=粗斜体</code>，<code>5=符号字体</code>(以 Adobe 符号编码表示)</td>
</tr>
<tr class="even">
<td><code>font.axis</code></td>
<td>坐标轴刻度文字的字体样式</td>
</tr>
<tr class="odd">
<td><code>font.lab</code></td>
<td>坐标轴标签(名称)的字体样式</td>
</tr>
<tr class="even">
<td><code>font.main</code></td>
<td>标题的字体样式</td>
</tr>
<tr class="odd">
<td><code>font.sub</code></td>
<td>副标题的字体样式</td>
</tr>
<tr class="even">
<td><code>ps</code></td>
<td>字体磅值(1 磅约为 1/72 英寸)。文本的最终大小为 <code>ps*cex</code></td>
</tr>
<tr class="odd">
<td><code>family</code></td>
<td>绘制文本时使用的字体族。标准的取值为 <code>serif</code>(衬线)、<code>sans</code>(无衬线)和 <code>mono</code>(等宽)</td>
</tr>
<tr class="even">
<td><code>cex</code></td>
<td>字体缩放。</td>
</tr>
<tr class="odd">
<td><code>cex.axis</code></td>
<td>坐标轴刻度文字的缩放倍数。类似于 <code>cex</code></td>
</tr>
<tr class="even">
<td><code>cex.lab</code></td>
<td>坐标轴标签(名称)的缩放倍数。类似于 <code>cex</code></td>
</tr>
<tr class="odd">
<td><code>cex.main</code></td>
<td>标题的缩放倍数。类似于 <code>cex</code></td>
</tr>
<tr class="even">
<td><code>cex.sub</code></td>
<td>副标题的缩放倍数。类似于 <code>cex</code></td>
</tr>
</tbody>
</table>
<h3 id="图像尺寸与边界尺寸">图像尺寸与边界尺寸</h3>
<table>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pin</code></td>
<td>以英寸表示的图形尺寸(宽和高)</td>
</tr>
<tr class="even">
<td><code>mai</code></td>
<td>以数值向量表示的边界大小，顺序为“下、左、上、右”，单位为英寸</td>
</tr>
<tr class="odd">
<td><code>mar</code></td>
<td>以数值向量表示的边界大小，顺序为“下、左、上、右”，单位为英分 。默认值为<code>c(5,4,4,2)+0.1</code></td>
</tr>
</tbody>
</table>
<p>例如上述代码中的：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">par(pin = c(<span class="number">4</span>, <span class="number">3</span>), mar = c(<span class="number">5</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>) + <span class="number">0.1</span>, family = <span class="string">"mono"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="自定义标题">自定义标题</h3>
<p>标题的参数：</p>
<table>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>main</code></td>
<td>主标题</td>
</tr>
<tr class="even">
<td><code>sub</code></td>
<td>副标题</td>
</tr>
<tr class="odd">
<td><code>xlab</code></td>
<td>x轴标签（名称）</td>
</tr>
<tr class="even">
<td><code>ylab</code></td>
<td>y轴标签（名称）</td>
</tr>
<tr class="odd">
<td><code>ann</code></td>
<td>禁用坐标轴上的标签，标尺以及默认标题</td>
</tr>
</tbody>
</table>
<p>设置标题可以在绘图函数（如<code>plot()</code>）中设置，可以用专门的函数<code>title()</code>来设置。由于某些高级绘图函数已经包含了默认的标题和标签，可以通过传入参数<code>ann=FALSE</code>来禁用这些默认值，然后再通过<code>title()</code>、<code>axis()</code>等函数来设置。</p>
<p>例如：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title(main=<span class="string">"My Title"</span>, sub=<span class="string">"My Subtitle"</span>, xlab=<span class="string">"My X label"</span>, ylab=<span class="string">"My Y label"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="坐标轴">坐标轴</h3>
<p>与坐标轴函数<code>asix()</code>相关的主要参数：</p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>side</code></td>
<td>一个整数，表示在图形的哪边绘制坐标轴(<code>1=下</code>，<code>2=左</code>，<code>3=上</code>，<code>4=右</code>)</td>
</tr>
<tr class="even">
<td><code>at</code></td>
<td>一个数值型向量，表示需要绘制刻度线的位置</td>
</tr>
<tr class="odd">
<td><code>labels</code></td>
<td>一个字符型向量，表示置于刻度线旁边的文字标签(如果为 <code>NULL</code>，则将直接使用 <code>at</code> 中的值)</td>
</tr>
<tr class="even">
<td><code>pos</code></td>
<td>坐标轴线绘制位置的坐标(即与另一条坐标轴相交位置的值)</td>
</tr>
<tr class="odd">
<td><code>lty</code></td>
<td>线条类型</td>
</tr>
<tr class="even">
<td><code>col</code></td>
<td>线条和刻度线颜色</td>
</tr>
<tr class="odd">
<td><code>las</code></td>
<td>0表示标签平行于坐标轴，2表示标签垂直于坐标轴</td>
</tr>
<tr class="even">
<td><code>tck</code></td>
<td>刻度线的长度，以相对于绘图区域大小的分数表示(负值表示在图形外侧，正值表示在图形内侧，0 表示禁用刻度，1 表示绘制网格线)；默认值为–0.01</td>
</tr>
</tbody>
</table>
<h3 id="添加新的直线或者曲线">添加新的直线或者曲线</h3>
<p><code>lines()</code>函数可以在原图基础上添加新的点线，它的参数列表类似于<code>plot()</code>函数，这里不再赘述。</p>
<p>函数<code>abline()</code>可以添加参考线，它的主要参数如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abline(h=yvalues, v=xvalues)</span><br></pre></td></tr></table></figure>
<p><code>h</code>和<code>v</code>既可以是数值，也可以是向量。</p>
<p>上述图像中添加了三条参考线：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加参考线，h参数指纵轴参考线，v参数指横轴参考线</span></span><br><span class="line">abline(h = c(<span class="number">5</span>), lwd = <span class="number">1.5</span>, lty = <span class="number">2</span>, col = <span class="string">"gray"</span>)</span><br><span class="line">abline(v = c(<span class="number">6</span>), lwd = <span class="number">1.5</span>, lty = <span class="number">3</span>, col = <span class="string">"gray"</span>)</span><br><span class="line"><span class="comment"># 添加一条拟合出的直线，也可以是曲线</span></span><br><span class="line">abline(lm(z ~ x), col = <span class="string">"gray"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="图例">图例</h3>
<p>也就是上图中左上角的那个曲线说明，通过<code>legend()</code>函数设置，它的主要参数如下：</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>location</code></td>
<td>有许多方式可以指定图例的位置。你可以直接给定图例左上角的 x、y 坐标，也可以执行 <code>locator(1)</code>， 然后通过鼠标单击给出图例的位置，还可以使用关键字 <code>bottom</code>、<code>bottomleft</code>、<code>left</code>、<code>topleft</code>、<code>top</code>、 <code>topright</code>、<code>right</code>、<code>bottomright</code> 或 <code>center</code> 放置图例。如果你使用了以上某个关键字，那么可以 同时使用参数 <code>inset=</code>指定图例向图形内侧移动的大小(以绘图区域大小的分数表示)</td>
</tr>
<tr class="even">
<td><code>title</code></td>
<td>图例标题的字符串（可选）</td>
</tr>
<tr class="odd">
<td><code>legend</code></td>
<td>图例标签组成的字符型向量</td>
</tr>
<tr class="even">
<td>...</td>
<td>其他选项。如果图例标示的是颜色不同的线条，需要指定<code>col=</code>加上颜色值组成的向量。如果图例标示的是符号不同的点，则需指定 <code>pch=</code>加上符号的代码组成的向量。如果图例标示的是不同的线条宽度或线条类型，请使用 <code>lwd=</code>或 <code>lty=</code>加上宽度值或类型值组成的向量。要为图例创建颜色填充的盒形(常见于条形图、箱线图或饼图)，需要使用参数 <code>fill=</code>加上颜色值组成的向量</td>
</tr>
</tbody>
</table>
<p>实例代码如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加图例，legend指图例说明，lty指线的类型，pch指点的类型，这确保这3个参数对应正确</span></span><br><span class="line">legend(<span class="string">"topleft"</span>, inset = <span class="number">0.05</span>, title = <span class="string">"Function"</span>, legend = c(<span class="string">"Y=X"</span>, <span class="string">"Y=1/X"</span>), </span><br><span class="line">       lty = c(<span class="number">3</span>, <span class="number">2</span>), pch = c(<span class="number">21</span>, <span class="number">22</span>), col = c(<span class="string">"red"</span>, <span class="string">"blue"</span>))</span><br></pre></td></tr></table></figure>
<h3 id="文本标注">文本标注</h3>
<p>上述图像中，我们使用了<code>mtext()</code>函数在图像的右侧添加了<code>y=1/x</code>这个字符串，还有一个更灵活的函数<code>text()</code>它可以在图像任意位置添加文本。两个函数的用法如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">text(location, <span class="string">"text to place"</span>, pos, <span class="keyword">...</span>)</span><br><span class="line">mtext(<span class="string">"text to place"</span>, side, line=n, <span class="keyword">...</span>)</span><br></pre></td></tr></table></figure>
<p>参数如下：</p>
<table>
<colgroup>
<col style="width: 14%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="header">
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>location</code></td>
<td>文本的位置参数。可为一对 x、y 坐标，也可通过指定 <code>location</code> 为 <code>locator(1)</code>使用鼠标交互式地确 定摆放位置</td>
</tr>
<tr class="even">
<td><code>pos</code></td>
<td>文本相对于位置参数的方位。1=下，2=左，3=上，4=右。如果指定了 <code>pos</code>，就可以同时指定参数 <code>offset=</code> 作为偏移量，以相对于单个字符宽度的比例表示</td>
</tr>
<tr class="odd">
<td><code>side</code></td>
<td>指定用来放置文本的边。1=下，2=左，3=上，4=右。你可以指定参数 <code>line=</code>来内移或外移文本，随着值的增加，文本将外移。也可使用 <code>adj=0</code> 将文本向左下对齐，或使用 <code>adj=1</code> 右上对齐</td>
</tr>
</tbody>
</table>
<h2 id="图形的组合">图形的组合</h2>
<p><code>par()</code>和<code>layout()</code>函数可以将多个图可以组合到一张图像中。</p>
<p>在<code>par()</code>函数中使用参数<code>mfrow=c(nrows, ncols)</code>来创建按行填充的、行数为 <code>nrows</code>、列数为<code>ncols</code>的图形矩阵。参数<code>mfcol=c(nrows, ncols)</code>则是按列填充。</p>
<p><code>par()</code>可以通过<code>fig</code>参数来设置每个子图的大小，<code>layout()</code>函数可以通过传入矩阵的方式来设置每个子图占几行几列。</p>
<h3 id="layout组合图像">layout()组合图像</h3>
<p><code>layout()</code>示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">attach</span>(mtcars)</span><br><span class="line">layout(matrix(c(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), <span class="number">2</span>, <span class="number">2</span>, byrow = <span class="literal">TRUE</span>), widths = c(<span class="number">3</span>, <span class="number">1</span>), heights = c(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">hist(wt)</span><br><span class="line">hist(mpg)</span><br><span class="line">hist(disp)</span><br><span class="line"><span class="keyword">detach</span>(mtcars)</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li>参数<code>matrix</code>是一个2×2的矩阵，它表示将图像设置成2×2的均匀布局，而矩阵中的值<code>c(1, 1, 2, 3)</code>表示整张图将容纳三个子图，子图1将占据第一行的两列（此处就是整个第一行），子图2将占据第二行第一列，子图3占第二行第二列;</li>
<li><code>widths</code>参数是列宽的比例，这里指第一列图像的宽度与第二列图像的宽度是3：1；</li>
<li><code>heights</code>参数是行高的比例，这里指第一行图像的高度与第二行图像的高度是1：2。</li>
</ol>
</blockquote>
<p>图像如下：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587281302/R/layout.png" /></p>
<h3 id="par组合图像">par()组合图像</h3>
<p>以下是<code>par()</code>组合图像的示例，它对每个子图的控制将更精细：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">opar &lt;- par(no.readonly = <span class="literal">TRUE</span>)</span><br><span class="line"></span><br><span class="line">par(fig = c(<span class="number">0</span>, <span class="number">0.8</span>, <span class="number">0</span>, <span class="number">0.8</span>))</span><br><span class="line">plot(mtcars$wt, mtcars$mpg, xlab = <span class="string">"Miles Per Gallon"</span>, ylab = <span class="string">"Car Weight"</span>)</span><br><span class="line"></span><br><span class="line">par(fig = c(<span class="number">0</span>, <span class="number">0.8</span>, <span class="number">0.55</span>, <span class="number">1</span>), new = <span class="literal">TRUE</span>)</span><br><span class="line">boxplot(mtcars$wt, horizontal = <span class="literal">TRUE</span>, axes = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line">par(fig = c(<span class="number">0.65</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0.8</span>), new = <span class="literal">TRUE</span>)</span><br><span class="line">boxplot(mtcars$mpg, axes = <span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line">mtext(<span class="string">"Enhanced Scatterplot"</span>, side = <span class="number">3</span>, outer = <span class="literal">TRUE</span>, line = -<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">par(opar)</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li><p>R的绘图原理：整张图片，左下角坐标是<code>(0, 0)</code>，右上角坐标是<code>(1, 1)</code>，图示如下：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587282292/R/fig.png" /></p></li>
<li><p><code>fig=c(x1, x2, y1, y2)</code>，4个值的范围均是<code>[0, 1]</code>，<code>fig</code>表示从<code>(x1, y1)</code>到<code>(x2, y2)</code>的向量，图像将画在以这个向量为对角线的矩形区域内；</p></li>
<li><p><code>fig=</code>默认会新建一幅图形，所以在添加一幅图到一幅现有图形上时，请设定参数<code>new=TRUE</code>。</p></li>
</ol>
</blockquote>
<p>以下是结果图：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587281302/R/par_fig.png" /></p>
<h1 id="基本数据处理">基本数据处理</h1>
<p>以下包含了对缺失值，日期值等数据的处理。</p>
<h2 id="缺失值处理">缺失值处理</h2>
<p><code>is.na()</code>函数用于检测缺失值，根据输入值的类型，返回一个布尔向量或者矩阵，<code>TRUE</code>表示该位置上的元素为<code>NA</code>。</p>
<p><code>na.omit()</code>函数可以删除所有含有缺失数据的行。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; y &lt;- c(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">NA</span>)</span><br><span class="line">&gt; is.na(y)	<span class="comment"># 返回一个向量，因为输入是一个向量</span></span><br><span class="line"><span class="literal">FALSE</span>, <span class="literal">FALSE</span>, <span class="literal">FALSE</span>, <span class="literal">TRUE</span></span><br><span class="line"><span class="comment"># 删除leadership中所有函数缺失值的行</span></span><br><span class="line">&gt; leadership &lt;- na.omit(leadership)</span><br></pre></td></tr></table></figure>
<p>关于缺失值还需要注意的是：</p>
<blockquote>
<ol type="1">
<li><p>缺失值被认为是不可比较的，即便是与缺失值自身比较；</p></li>
<li><p>R 并不把无限的或者不可能出现的数值标记成缺失值。</p>
<p>正负无穷分别用<code>Inf</code>和<code>-Inf</code>表示，用<code>is.infinite()</code>函数来判断；</p>
<p>不可能值用<code>NaN</code>（Not a Number）表示，用<code>is.nan()</code>判断；</p></li>
<li><p>含有缺失值的算术表达式和函数的计算结果也是缺失值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- c(<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NA</span>, <span class="number">3</span>)</span><br><span class="line">y &lt;- x[<span class="number">1</span>] + x[<span class="number">2</span>] + x[<span class="number">3</span>] + x[<span class="number">4</span>] <span class="comment"># 结果是缺失值</span></span><br><span class="line">z &lt;- sum(x)	<span class="comment"># 结果依然是缺失值</span></span><br><span class="line">zz &lt;- sum(x, na.rm = <span class="literal">TRUE</span>)	<span class="comment"># zz = 6</span></span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
<h2 id="日期值处理">日期值处理</h2>
<p>主要就是<code>Date</code>数据与字符串的相互转换。</p>
<p>这里只是一些简单的日期处理方法，功能更强大的日期处理函数可以下载lubridate包和timeDate包。</p>
<p>字符串到<code>Date</code>需要调用<code>as.Date()</code>函数，它预先定义了一些符号：</p>
<table>
<thead>
<tr class="header">
<th>符号</th>
<th>含义</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%d</code></td>
<td>数字表示的日期(0~31)</td>
<td>01~31</td>
</tr>
<tr class="even">
<td><code>%a</code></td>
<td>缩写的星期名</td>
<td>Mon</td>
</tr>
<tr class="odd">
<td><code>%A</code></td>
<td>非缩写星期名</td>
<td>Monday</td>
</tr>
<tr class="even">
<td><code>%m</code></td>
<td>月份(01~12)</td>
<td>01~12</td>
</tr>
<tr class="odd">
<td><code>%b</code></td>
<td>缩写的月份</td>
<td>Jan</td>
</tr>
<tr class="even">
<td><code>%B</code></td>
<td>非缩写月份</td>
<td>January</td>
</tr>
<tr class="odd">
<td><code>%y</code></td>
<td>两位数的年份</td>
<td>20</td>
</tr>
<tr class="even">
<td><code>%Y</code></td>
<td>四位数的年份</td>
<td>2020</td>
</tr>
</tbody>
</table>
<p><strong>日期默认的格式为：<code>yyyy-mm-dd</code></strong></p>
<p><code>Sys.Date()</code>返回当天日期，<code>date()</code>以字符串形式返回当前的日期和时间。</p>
<h3 id="字符串转date">字符串转Date</h3>
<p>示例：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; mydates &lt;- as.Date(c(<span class="string">"2007-06-22"</span>, <span class="string">"2004-02-13"</span>))</span><br><span class="line">&gt; mydates</span><br><span class="line">[<span class="number">1</span>] <span class="string">"2007-06-22"</span> <span class="string">"2004-02-13"</span></span><br><span class="line">&gt; class(mydates)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"Date"</span></span><br><span class="line">&gt; strDates &lt;- c(<span class="string">"01/05/1965"</span>, <span class="string">"08/16/1975"</span>)</span><br><span class="line">&gt; dates &lt;- as.Date(strDates, <span class="string">"%m/%d/%Y"</span>)</span><br><span class="line"></span><br><span class="line">&gt; Sys.Date()</span><br><span class="line">[<span class="number">1</span>] <span class="string">"2020-04-19"</span></span><br><span class="line">&gt; date()</span><br><span class="line">[<span class="number">1</span>] <span class="string">"Sun Apr 19 18:50:19 2020"</span></span><br></pre></td></tr></table></figure>
<h3 id="date转字符串">Date转字符串</h3>
<p>这里主要介绍两种方法：<code>format()</code>函数和<code>as.character()</code>函数，非常简单，以下是它们的用法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; format(Sys.Date(), format = <span class="string">"%B %d %Y"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"四月 19 2020"</span></span><br><span class="line">&gt; format(Sys.Date(), format=<span class="string">"%A"</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="string">"星期日"</span></span><br><span class="line">&gt; as.character(Sys.Date())</span><br><span class="line">[<span class="number">1</span>] <span class="string">"2020-04-19"</span></span><br></pre></td></tr></table></figure>
<h3 id="日期间的运算">日期间的运算</h3>
<p>两个Date对象可以通过相减来计算两者之间的时间差，也可以通过<code>difftime()</code>函数来计算日期间的差：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; strDates &lt;- c(<span class="string">"01/05/1965"</span>, <span class="string">"08/16/1975"</span>)</span><br><span class="line">&gt; dates &lt;- as.Date(strDates, <span class="string">"%m/%d/%Y"</span>)</span><br><span class="line">&gt; dates[<span class="number">2</span>] - dates[<span class="number">1</span>]</span><br><span class="line">Time difference of <span class="number">3875</span> days</span><br><span class="line"><span class="comment"># units支持："auto", "secs", "mins", "hours", "days", "weeks"，默认为"</span></span><br><span class="line">&gt; difftime(dates[<span class="number">2</span>], dates[<span class="number">1</span>], units = <span class="string">"weeks"</span>)</span><br><span class="line">Time difference of <span class="number">553.5714</span> weeks</span><br></pre></td></tr></table></figure>
<p>和其他语言一样，R语言的内部起始时间也是1970年1月1日，更早的事件需要表示为负数。</p>
<h2 id="类型转换">类型转换</h2>
<p>R中提供了一系列用 来判断某个对象的数据类型和将其转换为另一种数据类型的函数：</p>
<table>
<thead>
<tr class="header">
<th>判断(返回<code>TRUE</code>或<code>FALSE</code>)</th>
<th>转换</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>is.numeric()</code></td>
<td><code>as.numeric()</code></td>
</tr>
<tr class="even">
<td><code>is.character()</code></td>
<td><code>as.character()</code></td>
</tr>
<tr class="odd">
<td><code>is.vector()</code></td>
<td><code>as.vector()</code></td>
</tr>
<tr class="even">
<td><code>is.matrix()</code></td>
<td><code>as.matrix()</code></td>
</tr>
<tr class="odd">
<td><code>is.data.frame()</code></td>
<td><code>as.data.frame()</code></td>
</tr>
<tr class="even">
<td><code>is.factor()</code></td>
<td><code>as.factor()</code></td>
</tr>
<tr class="odd">
<td><code>is.logical()</code></td>
<td><code>as.logical()</code></td>
</tr>
</tbody>
</table>
<h2 id="数据排序">数据排序</h2>
<p><code>order()</code>函数对一个数据框进行排序。默认的排序顺序是升序。在排序变量的 前边加一个减号即可得到降序的排序结果：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按年龄升序排序</span></span><br><span class="line">newdata &lt;- leadership[order(leadership$age),]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先按性别升序排序，同性别按年龄降序排序</span></span><br><span class="line">newdata &lt;-leadership[order(leadership$gender, -leadership$age),]</span><br></pre></td></tr></table></figure>
<h2 id="数据集的合并">数据集的合并</h2>
<p>数据集的合并分为横向合并和纵向合并。</p>
<h3 id="横向合并合并列">横向合并：合并列</h3>
<p>形象的说，横向合并就是将两个数据集左右拼接在一起。</p>
<p>横向合并又分为<strong>按列（或者按某几列）合并</strong>与<strong>直接合并</strong>。</p>
<p><strong>按列合并</strong>类似于数据库查询中的多表查询，比如按<code>ID</code>和<code>Country</code>这两列合并数据框，调用的是<code>merge()</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">total &lt;- merge(dataframeA, dataframeB, by=c(<span class="string">"ID"</span>, <span class="string">"Country"</span>))</span><br></pre></td></tr></table></figure>
<p><strong>直接合并</strong>就相当于直接将两张表左右拼接在一起，调用的是<code>cbind()</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">total &lt;- cbind(dataframeA, dataframeB)</span><br></pre></td></tr></table></figure>
<h3 id="纵向合并">纵向合并</h3>
<p>其实就相当于两张结构相同的表合成一张大表，形象的说就是上下拼接，调用的是<code>rbind()</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">total &lt;- rbind(dataframeA, dataframeB)</span><br></pre></td></tr></table></figure>
<p>两个数据框必须拥有相同的变量，但变量顺序不必相同。</p>
<p>如果<code>dataframeA</code>中有 <code>dataframeB</code>中没有的变量，需做一定的处理：</p>
<ul>
<li>删除<code>dataframeA</code>中的多余变量；</li>
<li>在<code>dataframeB</code>中创建追加的变量并将其值设为<code>NA</code>。</li>
</ul>
<h2 id="数据框data.frame中的操作">数据框<code>data.frame</code>中的操作</h2>
<h3 id="两列相加并创建一个新列">两列相加并创建一个新列</h3>
<p>常用的两种方法，假设变量<code>mydata</code>是一个数据框，它只有<code>x1</code>和<code>x2</code>这两列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1：直接相加</span></span><br><span class="line">mydata$sumx &lt;- mydata$x1 + mydata$x2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2：使用transform()函数</span></span><br><span class="line">mydata &lt;- transform(mydata, sumx = x1 + x2)</span><br></pre></td></tr></table></figure>
<p>更使用<code>transform()</code>函数。</p>
<h3 id="变量重编码">变量重编码</h3>
<p>以以下三种操作为例：</p>
<ol type="1">
<li>将一个连续型变量修改为一组类别值;</li>
<li>将误编码的值替换为正确值;</li>
<li>基于一组临界值创建一个分类变量。</li>
</ol>
<p>例如<code>leadership</code>是一个数据框，它有一个<code>age</code>变量（列），现在需要将年龄为99的元素设置为缺失值，并根据年龄来分组，具体操作如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将99岁这个元素设置为NA</span></span><br><span class="line">leadership$age[leadership$age == <span class="number">99</span>] &lt;- <span class="literal">NA</span></span><br><span class="line">leadership$agecat[leadership$age &gt; <span class="number">75</span>] &lt;- <span class="string">"Elder"</span></span><br><span class="line">leadership$agecat[leadership$age &gt;= <span class="number">55</span> &amp; leadership$age &lt;= <span class="number">75</span>] &lt;- <span class="string">"Middle Aged"</span> </span><br><span class="line">leadership$agecat[leadership$age &lt; <span class="number">55</span>] &lt;- <span class="string">"Young"</span></span><br></pre></td></tr></table></figure>
<p>语句<code>variable[condition] &lt;- expression</code>将仅在<code>condition</code>的值为<code>TRUE</code>时执行赋值。</p>
<p>以上代码还可以使用<code>within()</code>函数来简化：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">leadership$age[leadership$age == <span class="number">99</span>] &lt;- <span class="literal">NA</span></span><br><span class="line"></span><br><span class="line">leadership &lt;- within(leadership, &#123;</span><br><span class="line">    agecat &lt;- <span class="literal">NA</span></span><br><span class="line">    agecat[age &gt; <span class="number">75</span>] &lt;- <span class="string">"Elder"</span></span><br><span class="line">    agecat[age &gt;= <span class="number">55</span> &amp; age &lt;= <span class="number">75</span>] &lt;- <span class="string">"Middle Aged"</span></span><br><span class="line">    agecat[age &lt; <span class="number">55</span>] &lt;- <span class="string">"Young"</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>提示：car包中的<code>recode()</code>函数，doBy包中的<code>recodevar()</code>函数以及R自带的<code>cut()</code>都可以用来重编码。</p>
</blockquote>
<h3 id="重命名列">重命名列</h3>
<p>使用<code>names()</code>函数重命名数据框中的列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第2列被重命名为了testDate</span></span><br><span class="line">names(leadership)[<span class="number">2</span>] &lt;- <span class="string">"testDate"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量重命名列</span></span><br><span class="line">names(leadership)[<span class="number">6</span>:<span class="number">10</span>] &lt;- c(<span class="string">"item1"</span>, <span class="string">"item2"</span>, <span class="string">"item3"</span>, <span class="string">"item4"</span>, <span class="string">"item5"</span>)</span><br></pre></td></tr></table></figure>
<p>提示：</p>
<blockquote>
<p>plyr包中的<code>rename()</code>函数更方便，只不过这个包并不是自带的：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模板</span></span><br><span class="line">rename(dataframe, c(oldname=<span class="string">"newname"</span>, oldname=<span class="string">"newname"</span>,<span class="keyword">...</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例：</span></span><br><span class="line"><span class="keyword">library</span>(plyr)</span><br><span class="line"><span class="comment"># manager列被重命名为了managerID，data列被重命名为了testDate列</span></span><br><span class="line">leadership &lt;- rename(leadership, c(manager=<span class="string">"managerID"</span>, date=<span class="string">"testDate"</span>))</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="选择某几列生成子集">选择某几列生成子集</h3>
<p>从原数据框中选择特定的列生成子集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择第6到10列，以及所有的行作为子集</span></span><br><span class="line">newdata &lt;- dataframeA[, c(<span class="number">6</span>:<span class="number">10</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等价代码：</span></span><br><span class="line">myvars &lt;- c(<span class="string">"col1"</span>, <span class="string">"col2"</span>, <span class="string">"col3"</span>, <span class="string">"col4"</span>, <span class="string">"col5"</span>) </span><br><span class="line">newdata &lt;-dataframeA[myvars]</span><br></pre></td></tr></table></figure>
<h3 id="删除数据框中的某些列">删除数据框中的某些列</h3>
<p>有些时候并不一定所有的列都是需要的，例如，可能某列的缺失值太多，需要删除该列：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1：当你知道你要删的是第几列时</span></span><br><span class="line">newdata &lt;- dataframeA[, -c(<span class="number">1</span>, <span class="number">2</span>)]</span><br><span class="line">newdata &lt;- dataframeA[c(-<span class="number">1</span>, -<span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2：</span></span><br><span class="line">myvars &lt;- names(dataframeA) %<span class="keyword">in</span>% c(<span class="string">"colx"</span>, <span class="string">"coly"</span>) </span><br><span class="line">newdata &lt;- dataframeA[!myvars]	<span class="comment"># 感叹号：取非运算</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法3：就不需要的列设置为NULL</span></span><br><span class="line">dataframeA$colx &lt;- dataframeA$coly &lt;- <span class="literal">NULL</span></span><br></pre></td></tr></table></figure>
<h3 id="选择或删除某些行">选择或删除某些行</h3>
<p>明确知道所需的数据在第几行，可以直接用下标；也可以通过条件判断：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法1</span></span><br><span class="line">newdata &lt;- dataframeA[<span class="number">1</span>:<span class="number">3</span>,]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法2</span></span><br><span class="line">newdata &lt;- dataframeA[dataframeA$gender==<span class="string">"M"</span> &amp; dataframeA$age &gt; <span class="number">30</span>,]</span><br></pre></td></tr></table></figure>
<h3 id="subset函数">subset()函数</h3>
<p>这个函数能非常方便的提取子集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据age选择行，根据select参数保留列</span></span><br><span class="line">newdata &lt;- subset(dataframeA, age &gt;= <span class="number">35</span> | age &lt; <span class="number">24</span>, select=c(q1, q2, q3, q4))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据age选择行，同时删除q1到q4之间所有的列</span></span><br><span class="line">newdata &lt;- subset(dataframeA, age &gt;= <span class="number">35</span> | age &lt; <span class="number">24</span>, select=-c(q1, q2, q3, q4))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据gender和age选择行，保留gender到q4之间所有的列</span></span><br><span class="line">newdata &lt;- subset(dataframeA, gender==<span class="string">"M"</span> &amp; age &gt; <span class="number">25</span>, select=gender:q4)</span><br></pre></td></tr></table></figure>
<h3 id="随机抽样">随机抽样</h3>
<p>其实就是利用随机抽样函数<code>sample()</code>来从数据框中取行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysample &lt;- leadership[sample(<span class="number">1</span>:nrow(leadership), <span class="number">3</span>, replace=<span class="literal">FALSE</span>),]</span><br></pre></td></tr></table></figure>
<p><code>sample()</code>函数的声明如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sample(range, k, replace=<span class="literal">FALSE</span>, prob=probility.vector)</span><br></pre></td></tr></table></figure>
<p>它表示从<code>range</code>这个数据集中随机抽取<code>k</code>个样本。<code>replace</code>参数表示是否为有放回抽样，<code>prob</code>表示每个样本被抽到的概率，如果没有设置则表示是等概率抽样。</p>
<h1 id="高级数据处理">高级数据处理</h1>
<p>本节主要介绍数据处理的基石函数，它们可分为两大类：<strong>数值函数</strong>（数学、统计、概率）和<strong>字符处理函数</strong>。</p>
<h2 id="数学函数">数学函数</h2>
<p>以下是常用的数学处理函数：</p>
<table>
<thead>
<tr class="header">
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>abs(x)</code></td>
<td>绝对值</td>
</tr>
<tr class="even">
<td><code>sqrt(x)</code></td>
<td>平方根</td>
</tr>
<tr class="odd">
<td><code>ceiling(x)</code></td>
<td>不小于 <code>x</code>的最小整数</td>
</tr>
<tr class="even">
<td><code>floor(x)</code></td>
<td>不大于 <code>x</code>的最大整数</td>
</tr>
<tr class="odd">
<td><code>trunc(x)</code></td>
<td>向 0 的方向截取的 <code>x</code> 中的整数部分</td>
</tr>
<tr class="even">
<td><code>round(x, digits=n)</code></td>
<td>将 <code>x</code> 舍入为指定位的小数（四舍五入）</td>
</tr>
<tr class="odd">
<td><code>signif(x, digits=n)</code></td>
<td>将 <code>x</code>舍入为指定的有效数字位数<br /><code>signif(3.475, digits=2)</code>返回值为 3.5</td>
</tr>
<tr class="even">
<td><code>cos(x)</code>、<code>sin(x)</code>、<code>tan(x)</code></td>
<td>余弦、正弦和正切</td>
</tr>
<tr class="odd">
<td><code>acos(x)</code>、<code>asin(x)</code>、<code>atan(x)</code></td>
<td>反余弦、反正弦和反正切</td>
</tr>
<tr class="even">
<td><code>log(x,base=n)</code></td>
<td>对<code>x</code>取以<code>n</code>为底的对数</td>
</tr>
<tr class="odd">
<td><code>log(x)</code></td>
<td>自然对数函数</td>
</tr>
<tr class="even">
<td><code>log10(x)</code></td>
<td>以10为底的对数函数</td>
</tr>
<tr class="odd">
<td><code>exp(x)</code></td>
<td>指数函数</td>
</tr>
</tbody>
</table>
<h2 id="统计函数">统计函数</h2>
<p>常用的统计函数：</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mean(x)</code></td>
<td>平均数</td>
</tr>
<tr class="even">
<td><code>median(x)</code></td>
<td>中位数</td>
</tr>
<tr class="odd">
<td><code>sd(x)</code></td>
<td>标准差</td>
</tr>
<tr class="even">
<td><code>var(x)</code></td>
<td>方差</td>
</tr>
<tr class="odd">
<td><code>mad(x)</code></td>
<td>绝对中位差(median absolute deviation)<br /><code>mad(c(1,2,3,4))</code>返回值为 1.48</td>
</tr>
<tr class="even">
<td><code>quantile(x,probs)</code></td>
<td>求分位数。其中<code>x</code> 为待求分位数的数值型向量，<code>probs</code> 为一个由<code>[0,1]</code>之间的概率值组成 的数值向量<br />例如，求<code>x</code>的30%和84%分位点：<code>y &lt;- quantile(x, c(.3,.84))</code></td>
</tr>
<tr class="odd">
<td><code>range(x)</code></td>
<td>求值域<br /><code>x &lt;- c(1,2,3,4)</code><br /><code>range(x)</code>返回值为 <code>c(1,4)</code><br /><code>diff(range(x))</code>返回值为 3</td>
</tr>
<tr class="even">
<td><code>sum(x)</code></td>
<td>求和</td>
</tr>
<tr class="odd">
<td><code>diff(x, lag=n)</code></td>
<td>滞后差分，<code>lag</code>用以指定滞后几项。默认的 <code>lag</code> 值为 1<br /><code>x&lt;- c(1, 5, 23, 29)</code><br /><code>diff(x)</code>返回值为 <code>c(4, 18, 6)</code></td>
</tr>
<tr class="even">
<td><code>min(x)</code></td>
<td>最小值</td>
</tr>
<tr class="odd">
<td><code>max(x)</code></td>
<td>最大值</td>
</tr>
<tr class="even">
<td><code>scale(x,center=TRUE,scale=TRUE)</code></td>
<td>为数据对象 <code>x</code> 按列进行中心化(<code>center=TRUE</code>)或标准化(<code>center=TRUE,scale=TRUE</code>)</td>
</tr>
</tbody>
</table>
<p>对于标准化函数<code>scala()</code>需要说明一下几点：</p>
<blockquote>
<ol type="1">
<li><p>默认<code>scala()</code>对矩阵或数据框中的每一列都进行均值为0，标准差为1的标准化；</p></li>
<li><p>如果要对每一列指定标准差和均值，需要如下调用：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SD是你指定的标准差，M是指定的均值</span></span><br><span class="line">newdata &lt;- scale(mydata)*SD + M</span><br></pre></td></tr></table></figure></li>
<li><p>要对指定列而不是整个矩阵或数据框进行标准化，可以调用<code>transform()</code>函数：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newdata &lt;- transform(mydata, myvar = scale(myvar)*<span class="number">10</span>+<span class="number">50</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
</blockquote>
<h2 id="概率函数">概率函数</h2>
<p>概率函数的命名规则如下：</p>
<p><code>[dpqr]distribution_abbreviation()</code></p>
<p>方括号中每个字母的含义如下：</p>
<ul>
<li>d：密度函数（density）</li>
<li>p：分布函数（distribution function）</li>
<li>q：分位数函数（quantile function）</li>
<li>r：生成随机数（随机偏差）</li>
</ul>
<p>常见概率函数如下：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587354607/R/常见概率分布.png" /></p>
<p>以正态分布分布<code>norm()</code>为例，结合之前那4个字母<code>[dpqr]</code>，对于正态分布，在R中，它的密度函数为<code>dnorm()</code>，分布函数为<code>pnorm()</code>，分位数函数为<code>qnorm()</code>，随机数生成函数则为<code>rnorm()</code>，以下是它们的例子：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587354940/R/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E5%87%BD%E6%95%B0%E7%A4%BA%E4%BE%8B.png" /></p>
<blockquote>
<p>在每次生成伪随机数的时候，函数都会使用一个不同的种子，因此也会产生不同的结果。你 可以通过函数<code>set.seed()</code>显式指定这个种子，让结果可以重现(reproducible)。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; runif(<span class="number">5</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.8725344</span> <span class="number">0.3962501</span> <span class="number">0.6826534</span> <span class="number">0.3667821</span> <span class="number">0.9255909</span> </span><br><span class="line">&gt; runif(<span class="number">5</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.4273903</span> <span class="number">0.2641101</span> <span class="number">0.3550058</span> <span class="number">0.3233044</span> <span class="number">0.6584988</span> </span><br><span class="line">&gt; set.seed(<span class="number">1234</span>)</span><br><span class="line">&gt; runif(<span class="number">5</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.1137034</span> <span class="number">0.6222994</span> <span class="number">0.6092747</span> <span class="number">0.6233794</span> <span class="number">0.8609154</span> </span><br><span class="line">&gt; set.seed(<span class="number">1234</span>)</span><br><span class="line">&gt; runif(<span class="number">5</span>)</span><br><span class="line">[<span class="number">1</span>] <span class="number">0.1137034</span> <span class="number">0.6222994</span> <span class="number">0.6092747</span> <span class="number">0.6233794</span> <span class="number">0.8609154</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="字符处理函数">字符处理函数</h2>
<p>以下是一些使用的字符串处理函数：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587356066/R/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0.png" /></p>
<h2 id="其他常用函数">其他常用函数</h2>
<p>以下函数不好将其归为某一类：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587356385/R/%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0.png" /></p>
<h2 id="将函数用于矩阵和数据框">将函数用于矩阵和数据框</h2>
<p>此处主要介绍<code>apply()</code>函数，它可以将任意函数”应用“到到矩阵、数组、数据框的任何维 度上。<code>apply()</code>函数的使用格式为:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply(x, MARGIN, FUN, <span class="keyword">...</span>)</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<blockquote>
<ol type="1">
<li><code>x</code>：数据对象；</li>
<li><code>MARGIN</code>：维度的下标。对于数据框和矩阵，<code>MARGIN=1</code>表示行，<code>MARGIN=2</code>表示列；</li>
<li><code>FUN</code>：传入的函数；</li>
<li><code>...</code>：任何想传递给<code>FUN</code>的参数</li>
</ol>
</blockquote>
<p><code>lapply()</code>和<code>sapply()</code>可将函数应用到列表(list)上。</p>
<p>一个值得注意的例子，<code>name</code>是一个<code>list</code>：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; name</span><br><span class="line">[[<span class="number">1</span>]]</span><br><span class="line">[<span class="number">1</span>] <span class="string">"John"</span>  <span class="string">"Davis"</span></span><br><span class="line"></span><br><span class="line">[[<span class="number">2</span>]]</span><br><span class="line">[<span class="number">1</span>] <span class="string">"Angela"</span>   <span class="string">"Williams"</span></span><br><span class="line"></span><br><span class="line">[[<span class="number">3</span>]]</span><br><span class="line">[<span class="number">1</span>] <span class="string">"Bullwinkle"</span> <span class="string">"Moose"</span>     </span><br><span class="line"></span><br><span class="line"><span class="comment"># 取得第2列</span></span><br><span class="line">&gt; Lastname &lt;- sapply(name, <span class="string">"["</span>, <span class="number">2</span>)</span><br><span class="line">&gt; Lastname</span><br></pre></td></tr></table></figure>
<p>作为一个程序员，不得不吐槽R语言的语法，<code>"["</code>居然是一个可以提取某个对象的一部分的函数。</p>
<h2 id="数据的聚合与重塑">数据的聚合与重塑</h2>
<p>本节主要针对矩阵和数据框。</p>
<h3 id="转置">转置</h3>
<p>矩阵或数据框的转置直接调用函数<code>t()</code>即可。</p>
<h3 id="聚合aggregate">聚合aggregate</h3>
<p>类似于MongoDB，ElasticSearch中的聚合，例如分组统计均值、求和等。</p>
<p>以下例子使用R自带的数据集mtcars。根据<code>cyl</code>和<code>gear</code>对数据进行分组，同时计算组内数据中每一项指标（也就是每一列）的均值：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; options(digits=<span class="number">3</span>)</span><br><span class="line">&gt; <span class="keyword">attach</span>(mtcars)</span><br><span class="line">&gt; aggdata &lt;- aggregate(mtcars, by=list(cyl, gear), FUN = mean, na.rm = <span class="literal">TRUE</span>)</span><br><span class="line">&gt; aggdata</span><br><span class="line">  Group.1 Group.2  mpg cyl disp  hp drat   wt qsec  vs   am gear carb</span><br><span class="line"><span class="number">1</span>       <span class="number">4</span>       <span class="number">3</span> <span class="number">21.5</span>   <span class="number">4</span>  <span class="number">120</span>  <span class="number">97</span> <span class="number">3.70</span> <span class="number">2.46</span> <span class="number">20.0</span> <span class="number">1.0</span> <span class="number">0.00</span>    <span class="number">3</span> <span class="number">1.00</span></span><br><span class="line"><span class="number">2</span>       <span class="number">6</span>       <span class="number">3</span> <span class="number">19.8</span>   <span class="number">6</span>  <span class="number">242</span> <span class="number">108</span> <span class="number">2.92</span> <span class="number">3.34</span> <span class="number">19.8</span> <span class="number">1.0</span> <span class="number">0.00</span>    <span class="number">3</span> <span class="number">1.00</span></span><br><span class="line"><span class="number">3</span>       <span class="number">8</span>       <span class="number">3</span> <span class="number">15.1</span>   <span class="number">8</span>  <span class="number">358</span> <span class="number">194</span> <span class="number">3.12</span> <span class="number">4.10</span> <span class="number">17.1</span> <span class="number">0.0</span> <span class="number">0.00</span>    <span class="number">3</span> <span class="number">3.08</span></span><br><span class="line"><span class="number">4</span>       <span class="number">4</span>       <span class="number">4</span> <span class="number">26.9</span>   <span class="number">4</span>  <span class="number">103</span>  <span class="number">76</span> <span class="number">4.11</span> <span class="number">2.38</span> <span class="number">19.6</span> <span class="number">1.0</span> <span class="number">0.75</span>    <span class="number">4</span> <span class="number">1.50</span></span><br><span class="line"><span class="number">5</span>       <span class="number">6</span>       <span class="number">4</span> <span class="number">19.8</span>   <span class="number">6</span>  <span class="number">164</span> <span class="number">116</span> <span class="number">3.91</span> <span class="number">3.09</span> <span class="number">17.7</span> <span class="number">0.5</span> <span class="number">0.50</span>    <span class="number">4</span> <span class="number">4.00</span></span><br><span class="line"><span class="number">6</span>       <span class="number">4</span>       <span class="number">5</span> <span class="number">28.2</span>   <span class="number">4</span>  <span class="number">108</span> <span class="number">102</span> <span class="number">4.10</span> <span class="number">1.83</span> <span class="number">16.8</span> <span class="number">0.5</span> <span class="number">1.00</span>    <span class="number">5</span> <span class="number">2.00</span></span><br><span class="line"><span class="number">7</span>       <span class="number">6</span>       <span class="number">5</span> <span class="number">19.7</span>   <span class="number">6</span>  <span class="number">145</span> <span class="number">175</span> <span class="number">3.62</span> <span class="number">2.77</span> <span class="number">15.5</span> <span class="number">0.0</span> <span class="number">1.00</span>    <span class="number">5</span> <span class="number">6.00</span></span><br><span class="line"><span class="number">8</span>       <span class="number">8</span>       <span class="number">5</span> <span class="number">15.4</span>   <span class="number">8</span>  <span class="number">326</span> <span class="number">300</span> <span class="number">3.88</span> <span class="number">3.37</span> <span class="number">14.6</span> <span class="number">0.0</span> <span class="number">1.00</span>    <span class="number">5</span> <span class="number">6.00</span></span><br></pre></td></tr></table></figure>
<p><code>Group.1</code>表示汽缸数量(4、6或8)，<code>Group.2</code>代表挡位数(3、4或5)。举例来说， 拥有4个汽缸和3个挡位车型的每加仑汽油行驶英里数(<code>mpg</code>)均值为21.5。</p>
<p>在使用<code>aggregate()</code>函数的时候，<code>by</code>中的变量必须在一个列表中(即使只有一个变量)。可以在列表中为各组声明自定义的名称，例如<code>by=list(Group.cyl=cyl, Group. gears=gear)</code>。</p>
<h3 id="reshape2包">reshape2包</h3>
<p>第三方包reshape2是一套重塑和整合数据集的万能工具。</p>
<p>使用该包大致分为两个步骤：首先将数据融合(melt)，以使每一行都是唯一的标识符变量组合。然后将数据重铸(cast)为想要的任何结构。在重铸过程中，可以使用任何函数对数据进行整合。</p>
<p>数据集的融合是将它重构为这样一种格式：每个测量变量独占一行，行中带有要唯一确定这个测量所需的标识符变量。调用的是<code>melt()</code>函数： <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将col1和col2作为唯一标识符</span></span><br><span class="line">meltdata &lt;- melt(data, id=c(<span class="string">"col1"</span>, <span class="string">"col2"</span>))</span><br></pre></td></tr></table></figure></p>
<p><code>dcast()</code>函数读取已融合的数据，并使用传入的公式和一个(可选的)用于整合数据的函数将其重塑。调用格式为:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newdata &lt;- dcast(md, formula, fun.aggregate)</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<blockquote>
<ol type="1">
<li><code>md</code>: 已融合的数据</li>
<li><code>formula</code>: 想要的最后结果，形式如下： <figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rowvar1 + rowvar2 + <span class="keyword">...</span> ~ colvar1 + colvar2 + <span class="keyword">...</span></span><br></pre></td></tr></table></figure> <code>rowvar1 + rowvar2 + ...</code>定义了要划掉的变量集合，以确定各行的内容，而<code>colvar1 + colvar2 + ...</code>则定义了要划掉的、确定各列内容的变量集合</li>
<li><code>fun.aggregate</code>: 可选的数据整合函数</li>
</ol>
</blockquote>
<p>融合与重铸的例子如下图所示（注意上方的代码）：</p>
<p><img src="https://res.cloudinary.com/vpointer/image/upload/v1587366667/R/%E8%9E%8D%E5%90%88%E4%B8%8E%E9%87%8D%E9%93%B8.png" /></p>
<p>需要提醒的是，不管有没有传入聚合函数，<strong>针对的都是<code>value</code>那一列中的值</strong>。</p>
<h1 id="r语言的控制流">R语言的控制流</h1>
<p>虽然以下概念对程序员并不陌生，但有些点还是需要注意：</p>
<ul>
<li>语句(statement)是一条单独的R语句或一组复合语句(包含在花括号<code>{}</code>中的一组R语句，如果要写在同一行，需要使用分号分隔，最好是换行);</li>
<li>条件(cond)是一条最终被解析为真(TRUE)或假(FALSE)的表达式;</li>
<li>表达式(expr)是一条数值或字符串的求值语句;</li>
<li>序列(seq)是一个数值或字符串序列。</li>
</ul>
<h2 id="循环">循环</h2>
<p>包括<code>for</code>循环和<code>while</code>循环，R里面没有<code>do...while</code>循环。</p>
<h3 id="for循环">for循环</h3>
<p>语法： <code>for (var in seq) statement</code></p>
<p>例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># print默认换行</span></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">10</span>)  print(<span class="string">"Hello"</span>) <span class="comment"># Hello会被输出10遍</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">10</span>) &#123;</span><br><span class="line">   print(<span class="string">"Hello"</span>)</span><br><span class="line">   print(<span class="string">"World"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在处理大数据集中的行和列时，R中的循环可能比较低效费时。只要可能，最好联用R中的内建数值/字符处理函数和<code>apply</code>族函数。</p>
<h3 id="while循环">while循环</h3>
<p>语法： <code>while (cond) statement</code></p>
<p>例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">i &lt;- <span class="number">10</span></span><br><span class="line"><span class="keyword">while</span> (i &gt; <span class="number">0</span>) &#123;print(<span class="string">"Hello"</span>); i &lt;- i - <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line">i &lt;- <span class="number">10</span></span><br><span class="line"><span class="keyword">while</span>(i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    print(<span class="string">"Hello"</span>)</span><br><span class="line">    i &lt;- i - <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="条件控制">条件控制</h2>
<p>包括<code>if-else</code>，<code>ifelse</code>和<code>switch</code>结构。</p>
<h3 id="if-else">if-else</h3>
<p>语法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (cond) statement</span><br><span class="line"><span class="keyword">if</span> (cond) statement1 <span class="keyword">else</span> statement2</span><br><span class="line"><span class="keyword">if</span> (cond1) statement1 <span class="keyword">else</span> <span class="keyword">if</span> statement2 <span class="keyword">else</span> statement3</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正确写法1：全部写到一行，不推荐</span></span><br><span class="line"><span class="keyword">if</span> (!is.factor(grade)) grade &lt;- as.factor(grade) <span class="keyword">else</span> print(<span class="string">"Grade already is a factor"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 花括号</span></span><br><span class="line"><span class="keyword">if</span> (!is.factor(grade)) &#123;</span><br><span class="line">    grade &lt;- as.factor(grade) </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment"># 不要换行！</span></span><br><span class="line">    print(<span class="string">"Grade already is a factor"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下写法均会报错：</span></span><br><span class="line"><span class="comment"># 错误写法1：</span></span><br><span class="line"><span class="keyword">if</span> (!is.factor(grade)) </span><br><span class="line">    grade &lt;- as.factor(grade) </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    print(<span class="string">"Grade already is a factor"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 错误写法2</span></span><br><span class="line"><span class="keyword">if</span> (!is.factor(grade)) &#123;</span><br><span class="line">    grade &lt;- as.factor(grade) </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="comment"># else不能换行</span></span><br><span class="line">    print(<span class="string">"Grade already is a factor"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ifelse结构">ifelse结构</h3>
<p><code>ifelse</code>结构是<code>if-else</code>结构比较紧凑的向量化版本，其语法为:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifelse(cond, statement1, statement2)</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ifelse(score &gt; <span class="number">0.5</span>, print(<span class="string">"Passed"</span>), print(<span class="string">"Failed"</span>)) </span><br><span class="line">outcome &lt;- ifelse (score &gt; <span class="number">0.5</span>, <span class="string">"Passed"</span>, <span class="string">"Failed"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="switch结构">switch结构</h3>
<p>语法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(expr, </span><br><span class="line">    case1 = statement1,</span><br><span class="line">    case2 = statement2,</span><br><span class="line">    <span class="keyword">...</span></span><br><span class="line">    default_statement <span class="comment"># 未匹配到时</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; feelings &lt;- c(<span class="string">"sad"</span>, <span class="string">"afraid"</span>)</span><br><span class="line">&gt; <span class="keyword">for</span> (i <span class="keyword">in</span> feelings) </span><br><span class="line">    print(</span><br><span class="line">        <span class="keyword">switch</span>(i, </span><br><span class="line">            happy = <span class="string">"I am glad you are happy"</span>, </span><br><span class="line">            afraid = <span class="string">"There is nothing to fear"</span>, </span><br><span class="line">            sad = <span class="string">"Cheer up"</span>, </span><br><span class="line">            angry = <span class="string">"Calm down now"</span></span><br><span class="line">            print(<span class="string">"failed to recognize the feeling"</span>) <span class="comment"># 未匹配到时</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">[<span class="number">1</span>] <span class="string">"Cheer up"</span></span><br><span class="line">[<span class="number">1</span>] <span class="string">"There is nothing to fear"</span></span><br></pre></td></tr></table></figure>
<h1 id="自定义函数">自定义函数</h1>
<p>函数的大致结构如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function_name &lt;- <span class="keyword">function</span>(arg1, arg2=默认值, <span class="keyword">...</span> ) &#123; <span class="comment"># 参数可以有默认值</span></span><br><span class="line">    statements</span><br><span class="line">    <span class="keyword">return</span>(object) <span class="comment"># 也可以去掉return，直接写object，同样可以返回object</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以下是两个自定义函数的例子：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 函数1</span></span><br><span class="line">mystats &lt;- <span class="keyword">function</span>(x, parametric = <span class="literal">TRUE</span>, print = <span class="literal">FALSE</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (parametric) &#123;</span><br><span class="line">        center &lt;- mean(x)</span><br><span class="line">        spread &lt;- sd(x)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        center &lt;- median(x)</span><br><span class="line">        spread &lt;- mad(x)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (print &amp; parametric) &#123;</span><br><span class="line">        cat(<span class="string">"Mean="</span>, center, <span class="string">"\n"</span>, <span class="string">"SD="</span>, spread, <span class="string">"\n"</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (print &amp; !parametric) &#123;</span><br><span class="line">        cat(<span class="string">"Median="</span>, center, <span class="string">"\n"</span>, <span class="string">"MAD="</span>, spread, <span class="string">"\n"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    result &lt;- list(center = center, spread = spread)</span><br><span class="line">    <span class="keyword">return</span>(result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数2</span></span><br><span class="line">mydate &lt;- <span class="keyword">function</span>(type = <span class="string">"long"</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span>(type, </span><br><span class="line">        long = format(Sys.time(), <span class="string">"%A %B %d %Y"</span>), </span><br><span class="line">        short = format(Sys.time(), <span class="string">"%m-%d-%y"</span>), </span><br><span class="line">        cat(type, <span class="string">"is not a recognized type\n"</span>)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="reference">Reference</h1>
<ol type="1">
<li>《R语言实战第2版》</li>
<li><a href="https://zhuanlan.zhihu.com/p/46210816" target="_blank" rel="noopener">Vignette介绍</a></li>
<li><a href="https://stackoverflow.com/questions/8855589/a-comprehensive-survey-of-the-types-of-things-in-r-mode-and-class-and-type" target="_blank" rel="noopener"><code>class()</code>和<code>typeof()</code>函数的区别</a></li>
</ol>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>嘴强黑铁
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://www.zuiqiangiron.xyz/2020/04/16/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/" title="R语言入门">https://www.zuiqiangiron.xyz/2020/04/16/R语言入门/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/R%E8%AF%AD%E8%A8%80/" rel="tag"># R语言</a>
              <a href="/tags/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/" rel="tag"># R语言入门</a>
          </div>

        
  <div class="post-widgets">
    <div class="wp_rating">
      <div id="wpac-rating"></div>
    </div>
  </div>


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/15/Maven%20Notes/" rel="prev" title="Maven笔记">
      <i class="fa fa-chevron-left"></i> Maven笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/04/21/R%E8%AF%AD%E8%A8%80%E5%9F%BA%E6%9C%AC%E5%9B%BE%E5%BD%A2/" rel="next" title="R语言基本图形">
      R语言基本图形 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#写在最前的零散要点"><span class="nav-number">1.</span> <span class="nav-text">写在最前的零散要点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#新手须知"><span class="nav-number">2.</span> <span class="nav-text">新手须知</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#r语言数据结构"><span class="nav-number">3.</span> <span class="nav-text">R语言数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#标量"><span class="nav-number">3.1.</span> <span class="nav-text">标量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#向量vector"><span class="nav-number">3.2.</span> <span class="nav-text">向量vector</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#矩阵matrix"><span class="nav-number">3.3.</span> <span class="nav-text">矩阵matrix</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组array"><span class="nav-number">3.4.</span> <span class="nav-text">数组array</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据框data.frame"><span class="nav-number">3.5.</span> <span class="nav-text">数据框data.frame</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#attachdetach和with"><span class="nav-number">3.5.1.</span> <span class="nav-text">attach()、detach()和with()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#因子factor"><span class="nav-number">3.6.</span> <span class="nav-text">因子factor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列表"><span class="nav-number">3.7.</span> <span class="nav-text">列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一些处理数据对象的实用函数"><span class="nav-number">3.8.</span> <span class="nav-text">一些处理数据对象的实用函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据的输入"><span class="nav-number">4.</span> <span class="nav-text">数据的输入</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#从带分隔符的文件读入数据"><span class="nav-number">4.1.</span> <span class="nav-text">从带分隔符的文件读入数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#read.csv函数"><span class="nav-number">4.1.1.</span> <span class="nav-text">read.csv()函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#从键盘读入数据"><span class="nav-number">4.2.</span> <span class="nav-text">从键盘读入数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#读取excel文件"><span class="nav-number">4.3.</span> <span class="nav-text">读取Excel文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#图形初阶"><span class="nav-number">5.</span> <span class="nav-text">图形初阶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#散点图"><span class="nav-number">5.1.</span> <span class="nav-text">散点图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#点线的形状"><span class="nav-number">5.1.1.</span> <span class="nav-text">点线的形状</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#颜色"><span class="nav-number">5.1.2.</span> <span class="nav-text">颜色</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文本字体与大小"><span class="nav-number">5.1.3.</span> <span class="nav-text">文本字体与大小</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图像尺寸与边界尺寸"><span class="nav-number">5.1.4.</span> <span class="nav-text">图像尺寸与边界尺寸</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义标题"><span class="nav-number">5.1.5.</span> <span class="nav-text">自定义标题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#坐标轴"><span class="nav-number">5.1.6.</span> <span class="nav-text">坐标轴</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#添加新的直线或者曲线"><span class="nav-number">5.1.7.</span> <span class="nav-text">添加新的直线或者曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图例"><span class="nav-number">5.1.8.</span> <span class="nav-text">图例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文本标注"><span class="nav-number">5.1.9.</span> <span class="nav-text">文本标注</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#图形的组合"><span class="nav-number">5.2.</span> <span class="nav-text">图形的组合</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#layout组合图像"><span class="nav-number">5.2.1.</span> <span class="nav-text">layout()组合图像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#par组合图像"><span class="nav-number">5.2.2.</span> <span class="nav-text">par()组合图像</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基本数据处理"><span class="nav-number">6.</span> <span class="nav-text">基本数据处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#缺失值处理"><span class="nav-number">6.1.</span> <span class="nav-text">缺失值处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#日期值处理"><span class="nav-number">6.2.</span> <span class="nav-text">日期值处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串转date"><span class="nav-number">6.2.1.</span> <span class="nav-text">字符串转Date</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#date转字符串"><span class="nav-number">6.2.2.</span> <span class="nav-text">Date转字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日期间的运算"><span class="nav-number">6.2.3.</span> <span class="nav-text">日期间的运算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类型转换"><span class="nav-number">6.3.</span> <span class="nav-text">类型转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据排序"><span class="nav-number">6.4.</span> <span class="nav-text">数据排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据集的合并"><span class="nav-number">6.5.</span> <span class="nav-text">数据集的合并</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#横向合并合并列"><span class="nav-number">6.5.1.</span> <span class="nav-text">横向合并：合并列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#纵向合并"><span class="nav-number">6.5.2.</span> <span class="nav-text">纵向合并</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据框data.frame中的操作"><span class="nav-number">6.6.</span> <span class="nav-text">数据框data.frame中的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#两列相加并创建一个新列"><span class="nav-number">6.6.1.</span> <span class="nav-text">两列相加并创建一个新列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量重编码"><span class="nav-number">6.6.2.</span> <span class="nav-text">变量重编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重命名列"><span class="nav-number">6.6.3.</span> <span class="nav-text">重命名列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#选择某几列生成子集"><span class="nav-number">6.6.4.</span> <span class="nav-text">选择某几列生成子集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除数据框中的某些列"><span class="nav-number">6.6.5.</span> <span class="nav-text">删除数据框中的某些列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#选择或删除某些行"><span class="nav-number">6.6.6.</span> <span class="nav-text">选择或删除某些行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#subset函数"><span class="nav-number">6.6.7.</span> <span class="nav-text">subset()函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#随机抽样"><span class="nav-number">6.6.8.</span> <span class="nav-text">随机抽样</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#高级数据处理"><span class="nav-number">7.</span> <span class="nav-text">高级数据处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数学函数"><span class="nav-number">7.1.</span> <span class="nav-text">数学函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#统计函数"><span class="nav-number">7.2.</span> <span class="nav-text">统计函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#概率函数"><span class="nav-number">7.3.</span> <span class="nav-text">概率函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符处理函数"><span class="nav-number">7.4.</span> <span class="nav-text">字符处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他常用函数"><span class="nav-number">7.5.</span> <span class="nav-text">其他常用函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#将函数用于矩阵和数据框"><span class="nav-number">7.6.</span> <span class="nav-text">将函数用于矩阵和数据框</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据的聚合与重塑"><span class="nav-number">7.7.</span> <span class="nav-text">数据的聚合与重塑</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#转置"><span class="nav-number">7.7.1.</span> <span class="nav-text">转置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#聚合aggregate"><span class="nav-number">7.7.2.</span> <span class="nav-text">聚合aggregate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reshape2包"><span class="nav-number">7.7.3.</span> <span class="nav-text">reshape2包</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#r语言的控制流"><span class="nav-number">8.</span> <span class="nav-text">R语言的控制流</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#循环"><span class="nav-number">8.1.</span> <span class="nav-text">循环</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#for循环"><span class="nav-number">8.1.1.</span> <span class="nav-text">for循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#while循环"><span class="nav-number">8.1.2.</span> <span class="nav-text">while循环</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#条件控制"><span class="nav-number">8.2.</span> <span class="nav-text">条件控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if-else"><span class="nav-number">8.2.1.</span> <span class="nav-text">if-else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ifelse结构"><span class="nav-number">8.2.2.</span> <span class="nav-text">ifelse结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#switch结构"><span class="nav-number">8.2.3.</span> <span class="nav-text">switch结构</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#自定义函数"><span class="nav-number">9.</span> <span class="nav-text">自定义函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reference"><span class="nav-number">10.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="嘴强黑铁"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">嘴强黑铁</p>
  <div class="site-description" itemprop="description">一顿操作猛如虎</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">73</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">74</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">嘴强黑铁</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e731fa9610694ef" async="async"></script>
  </div>

        
<div class="busuanzi-count">
  <script pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.getAttribute('pjax') !== null) {
      script.setAttribute('pjax', '');
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  



  <script pjax>
  if (CONFIG.page.isPost) {
    wpac_init = window.wpac_init || [];
    wpac_init.push({
      widget: 'Rating',
      id    : 24025,
      el    : 'wpac-rating',
      color : 'fc6423'
    });
    (function() {
      if ('WIDGETPACK_LOADED' in window) return;
      WIDGETPACK_LOADED = true;
      var mc = document.createElement('script');
      mc.type = 'text/javascript';
      mc.async = true;
      mc.src = '//embed.widgetpack.com/widget.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
    })();
  }
  </script>

  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://zuiqiangiron.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://www.zuiqiangiron.xyz/2020/04/16/R%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/";
    this.page.identifier = "2020/04/16/R语言入门/";
    this.page.title = "R语言入门";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://zuiqiangiron.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

    </div>
</body>
</html>
